const t={debug:!1,locale:"en-US",enableShadowDom:!0,enableMainWrapper:!0,enableRouter:!0,autoInsertMainWrapper:!1,autoInit:!0,mainTagName:"app-main",routerTagName:"view-router",layoutPath:"",autoLoadFromImportMap:!1,optimizeList:!0,optimizeListElements:!0,optimizeAccessor:!0};function n(){return t}const e=n();function s(t){throw new Error(`${t} requires at least one option`)}function i(t){throw new Error(`${t} requires a number as option`)}function r(t){throw new Error(`${t} requires a number value`)}function o(t){throw new Error(`${t} requires a date value`)}const l=n(),u={eq:t=>{const n=t?.[0]??s("eq");return t=>{if("number"==typeof t){const e=Number(n);return isNaN(e)&&i("eq"),t===e}return t===n}},ne:t=>{const n=t?.[0]??s("ne");return t=>{if("number"==typeof t){const e=Number(n);return isNaN(e)&&i("eq"),t!==e}return t!==n}},not:t=>t=>("boolean"!=typeof t&&function(t){throw new Error(`${t} requires a boolean value`)}("not"),!t),lt:t=>{const n=t?.[0]??s("lt"),e=Number(n);return isNaN(e)&&i("lt"),t=>("number"!=typeof t&&r("lt"),t<e)},le:t=>{const n=t?.[0]??s("le"),e=Number(n);return isNaN(e)&&i("le"),t=>("number"!=typeof t&&r("le"),t<=e)},gt:t=>{const n=t?.[0]??s("gt"),e=Number(n);return isNaN(e)&&i("gt"),t=>("number"!=typeof t&&r("gt"),t>e)},ge:t=>{const n=t?.[0]??s("ge"),e=Number(n);return isNaN(e)&&i("ge"),t=>("number"!=typeof t&&r("ge"),t>=e)},inc:t=>{const n=t?.[0]??s("inc"),e=Number(n);return isNaN(e)&&i("inc"),t=>("number"!=typeof t&&r("inc"),t+e)},dec:t=>{const n=t?.[0]??s("dec"),e=Number(n);return isNaN(e)&&i("dec"),t=>("number"!=typeof t&&r("dec"),t-e)},mul:t=>{const n=t?.[0]??s("mul"),e=Number(n);return isNaN(e)&&i("mul"),t=>("number"!=typeof t&&r("mul"),t*e)},div:t=>{const n=t?.[0]??s("div"),e=Number(n);return isNaN(e)&&i("div"),t=>("number"!=typeof t&&r("div"),t/e)},fix:t=>{const n=Number(t?.[0]??0);return isNaN(n)&&i("div"),t=>("number"!=typeof t&&r("div"),t.toFixed(n))},locale:t=>{const n=t?.[0]??l.locale;return t=>("number"!=typeof t&&r("locale"),t.toLocaleString(n))},uc:t=>t=>t.toString().toUpperCase(),lc:t=>t=>t.toString().toLowerCase(),cap:t=>t=>{const n=t.toString();return 0===n.length?n:1===n.length?n.toUpperCase():n.charAt(0).toUpperCase()+n.slice(1)},trim:t=>t=>t.toString().trim(),slice:t=>{const n=t?.[0]??s("slice"),e=Number(n);return isNaN(e)&&i("slice"),t=>t.toString().slice(e)},substr:t=>{const n=t?.[0]??s("substr"),e=Number(n);isNaN(e)&&i("substr");const r=t?.[1]??s("substr"),o=Number(r);return isNaN(o)&&i("substr"),t=>t.toString().substr(e,o)},pad:t=>{const n=t?.[0]??s("pad"),e=Number(n);isNaN(e)&&i("pad");const r=t?.[1]??"0";return t=>t.toString().padStart(e,r)},rep:t=>{const n=t?.[0]??s("rep"),e=Number(n);return isNaN(e)&&i("rep"),t=>t.toString().repeat(e)},rev:t=>t=>t.toString().split("").reverse().join(""),int:t=>t=>parseInt(t,10),float:t=>t=>parseFloat(t),round:t=>{const n=t?.[0]??0,e=Math.pow(10,Number(n));return isNaN(e)&&i("round"),t=>("number"!=typeof t&&r("round"),Math.round(t*e)/e)},floor:t=>{const n=t?.[0]??0,e=Math.pow(10,Number(n));return isNaN(e)&&i("floor"),t=>("number"!=typeof t&&r("floor"),Math.floor(t*e)/e)},ceil:t=>{const n=t?.[0]??0,e=Math.pow(10,Number(n));return isNaN(e)&&i("ceil"),t=>("number"!=typeof t&&r("ceil"),Math.ceil(t*e)/e)},percent:t=>{const n=Number(t?.[0]??0);return isNaN(n)&&i("percent"),t=>("number"!=typeof t&&r("percent"),t.toFixed(n)+"%")},date:t=>{const n=t?.[0]??l.locale;return t=>(t instanceof Date||o("date"),t.toLocaleDateString(n))},time:t=>{const n=t?.[0]??l.locale;return t=>(t instanceof Date||o("time"),t.toLocaleTimeString(n))},datetime:t=>{const n=t?.[0]??l.locale;return t=>(t instanceof Date||o("datetime"),t.toLocaleString(n))},ymd:t=>{const n=t?.[0]??"-";return t=>{t instanceof Date||o("ymd");const e=t.getFullYear().toString(),s=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${e}${n}${s}${n}${i}`}},falsy:t=>t=>!1===t||null==t||0===t||""===t||Number.isNaN(t),truthy:t=>t=>!1!==t&&null!=t&&0!==t&&""!==t&&!Number.isNaN(t),defaults:t=>{const n=t?.[0]??s("defaults");return t=>!1===t||null==t||0===t||""===t||Number.isNaN(t)?n:t},boolean:t=>t=>Boolean(t),number:t=>t=>Number(t),string:t=>t=>String(t),null:t=>t=>""===t?null:t},a=u,c=u;let h=0;function d(){return++h}function f(t){throw new Error(t)}const p={};const m={};function g(t,n){const e=new CSSStyleSheet;e.replaceSync(n),function(t,n){m[t]=n}(t,e)}function w(t,n){const e=t[n.name];return e||f(`outputBuiltinFiltersFn: filter not found: ${name}`),e(n.options)}const y=new Map;function b(t,n){let e=y.get(n);if(void 0===e){e=[];for(let s=0;s<n.length;s++)e.push(w(t,n[s]));y.set(n,e)}return e}class N{#t;#n;#e;#s;#i;#r=new Set;get node(){return this.#n}get name(){return this.#e}get t(){return this.#e}get binding(){return this.#t}get i(){return this.#i}get filters(){return this.#s}get o(){return this.#r}constructor(t,n,e,s,i){this.#t=t,this.#n=n,this.#e=e,this.#s=s,this.#i=i}init(){}update(){this.l(this.binding.h.u)}l(t){f("BindingNode: assignValue not implemented")}p(t,n){f("BindingNode: updateElements not implemented")}m(t){}get N(){return this.node instanceof HTMLSelectElement}get value(){return null}get u(){return null}get S(){return!1}}class x extends N{#o;get t(){return this.#o}constructor(t,n,e,s,i){super(t,n,e,s,i);const[,r]=this.name.split(".");this.#o=r}l(t){(null==t||Number.isNaN(t))&&(t="");this.node.setAttribute(this.t,t.toString())}}class S extends N{l(t){Array.isArray(t)||f("BindingNodeCheckbox.update: value is not array");const n=this.node;n.checked=t.map((t=>t.toString())).includes(n.value)}}class v extends N{l(t){Array.isArray(t)||f("BindingNodeClassList.update: value is not array");this.node.className=t.join(" ")}}class $ extends N{#o;get t(){return this.#o}constructor(t,n,e,s,i){super(t,n,e,s,i);const[,r]=this.name.split(".");this.#o=r}l(t){"boolean"!=typeof t&&f("BindingNodeClassName.update: value is not boolean");const n=this.node;t?n.classList.add(this.t):n.classList.remove(this.t)}}class I extends N{#o;constructor(t,n,e,s,i){super(t,n,e,s,i),this.#o=this.name.slice(2);n.addEventListener(this.t,(t=>this.v(t)))}get t(){return this.#o}update(){}async v(t){const n=this.binding.$,e=this.binding.C.I,s=e?.P().map((t=>t.B.index))??[],i=this.i,r=this.binding.h.value;"function"!==typeof r&&f(`BindingNodeEvent: ${this.name} is not a function.`),i.includes("preventDefault")&&t.preventDefault(),i.includes("stopPropagation")&&t.stopPropagation(),await n.T(e,(async n=>{await Reflect.apply(r,n,[t,...s])}))}}const C=(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new I(s,i,t,o,e)},P="data-bind",B="@@:",E="@@|";class T extends N{#l;get id(){return this.#l}constructor(t,n,e,s,i){super(t,n,e,s,i);const r=this.node.textContent?.slice(3)??f("BindingNodeBlock.id: invalid node");this.#l=Number(r)}}class k extends T{#u;#a;#c=new Set;#r;get o(){return this.#r}constructor(t,n,e,s,i){super(t,n,e,s,i),this.#u=zt(this.binding,this.id,this.binding.$,"",null),this.#a=this.#r=new Set([this.#u])}l(t){"boolean"!=typeof t&&f("BindingNodeIf.update: value is not boolean");const n=this.node.parentNode;null==n&&f("BindingNodeIf.update: parentNode is null"),t?(this.#u.k(n,this.node),this.#u.L(),this.#r=this.#a):(this.#u.unmount(),this.#r=this.#c)}}class L extends T{#h=new Set;#d=new WeakMap;#f=[];#p=0;#m=new Set;get o(){return this.#h}get S(){return!0}init(){}M(t){let n;return this.#p>=0?(n=this.#f[this.#p],this.#p--,n.R(t)):n=zt(this.binding,this.id,this.binding.$,this.binding.h.pattern+".*",t),this.#d.set(t,n),n}F(t){t.unmount(),t.V?.A()}get O(){return this.#p}set O(t){this.#p=t}get H(){return this.#f.length}set H(t){t<0&&f("BindingNodeFor.setPoolLength: length is negative"),this.#f.length=t}l(t){Array.isArray(t)||f("BindingNodeFor.assignValue: value is not array");const n=this.binding.$.W(this.binding.h.info,this.binding.h.B);null===n&&f("BindingNodeFor.assignValue: listIndexes is not found");const e=new Set;let s=null;const i=new Set,r=this.#m.difference(n);for(const t of r){const n=this.#d.get(t);n&&(this.F(n),i.add(n))}this.#f.push(...i);const o=this.node.parentNode??f("BindingNodeFor.update: parentNode is null"),l=this.node;this.O=this.H-1;for(const t of n){const n=s?.j(o)??l;let i=this.#d.get(t);void 0===i?(i=this.M(t),i.k(o,n),i.L()):n?.nextSibling!==i.q&&i.k(o,n),e.add(i),s=i}this.H=this.O+1,this.#h=e,this.#m=new Set(n)}p(t,n){if("object"!=typeof n[0])return;const e=this.binding.$,s=e.D(this.binding.h.info,this.binding.h.B)??f("BindingNodeFor.updateElements: oldValues is not found"),i=this.node.parentNode??f("BindingNodeFor.update: parentNode is null"),r=Array.from(this.#h),o=[];for(let n=0;n<t.length;n++){const e=r[t[n].index];e.unmount(),o.push(e)}for(let e=0;e<t.length;e++){const l=t[e],u=l.index,a=r[u-1]??null,c=a?._??this.node,h=s[u],d=n.indexOf(h),f=o[d];if(void 0===f){const t=o[u];t.L(),t.k(i,c)}else f.R(l),f.k(i,c),this.#d.set(l,f),r[u]=f;d>=0&&(n[d]=-1)}this.#h=new Set(r),e.G(this.binding.h.info,this.binding.h.B,this.binding.h.value.slice(0))}}const M=(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new L(s,i,t,o,e)},R="textContent",F={radio:"checked",checkbox:"checked",button:"onclick"},A={},V={HTMLElement:t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLOptionElement?"value":t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement?"onclick":t instanceof HTMLFormElement?"onsubmit":t instanceof HTMLInputElement?F[t.type]??"value":R,SVGElement:void 0,Text:t=>R,Z:void 0};const O={value:"input",checked:"change",selected:"change"};class H extends N{get value(){return this.node[this.name]}get u(){let t=this.value;for(let n=0;n<this.filters.length;n++)t=this.filters[n](t);return t}constructor(t,n,e,s,i){super(t,n,e,s,i);if(!(this.node instanceof HTMLElement))return;if(!((r=this.node)instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement))return;var r;const o=function(t,n){const e=t.constructor.name+"\t"+(t.type??"");return A[e]??(A[e]=V[n]?.(t))}(this.node,"HTMLElement");if(o!==this.name)return;i.length>1&&f(`BindingNodeProperty: ${this.name} has multiple decorators`);const l=(i[0]?.startsWith("on")?i[0]?.slice(2):i[0])??null??O[this.name]??"readonly";if("readonly"===l||"ro"===l)return;const u=this.binding.$;this.node.addEventListener(l,(async()=>{const n=this.binding.C.I,e=this.u;await u.T(n,(async n=>{t.U(n,e)}))}))}init(){}l(t){(null==t||Number.isNaN(t))&&(t=""),this.node[this.name]=t}}const W=(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new H(s,i,t,o,e)};class z extends N{l(t){(null==t||Number.isNaN(t))&&(t="");const n=this.node;n.checked=t.toString()===n.value.toString()}}class j extends N{#o;get t(){return this.#o}constructor(t,n,e,s,i){super(t,n,e,s,i);const[,r]=this.name.split(".");this.#o=r}l(t){(null==t||Number.isNaN(t))&&(t="");this.node.style.setProperty(this.t,t.toString())}}const q="component-state-input",D=Symbol.for(`${q}.AssignState`),_=Symbol.for(`${q}.NotifyRedraw`),G=new WeakMap;class Z extends N{#o;get t(){return this.#o}constructor(t,n,e,s,i){super(t,n,e,s,i);const[,r]=this.name.split(".");this.#o=r}init(){const t=this.binding.$;var n,e;n=t.J,e=this.node,G.set(e,n);let s=t.K.get(this.node);void 0===s&&t.K.set(this.node,s=new Set),s.add(this.binding)}l(t){}m(t){const n=[],e=this.binding.h.info,s=this.binding.h.B?.at(e.X-1)??null,i=(s?.length??0)-1;for(const r of t)null!==s&&r.B?.at(i)!==s||r.info.Y.has(e.pattern)&&n.push(r);if(0===n.length)return;this.node.state[_](n)}}const U={0:{class:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new v(s,i,t,o,e)},checkbox:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new S(s,i,t,o,e)},radio:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new z(s,i,t,o,e)}},1:{if:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new k(s,i,t,o,e)}}},J={class:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new $(s,i,t,o,e)},attr:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new x(s,i,t,o,e)},style:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new j(s,i,t,o,e)},state:(t,n,e)=>(s,i,r)=>{const o=b(r,n);return new Z(s,i,t,o,e)}};const K={};function Q(t,n,e,s){const i=t instanceof Comment,r=t instanceof Element,o=i+"\t"+r+"\t"+n,l=K[o]??(K[o]=function(t,n,e){const s=U[t?1:0][e];if(void 0!==s)return s;if(t&&"for"===e)return M;t&&f(`getBindingNodeCreator: unknown node property ${e}`);const i=e.split("."),r=J[i[0]];return void 0!==r?r:n&&e.startsWith("on")?C:W}(i,r,n));return l(n,e,s)}const X="state",Y=Symbol.for(`${X}.GetByRef`),tt=Symbol.for(`${X}.SetByRef`),nt=Symbol.for(`${X}.SetCacheable`),et=Symbol.for(`${X}.ConnectedCallback`),st=Symbol.for(`${X}.DisconnectedCallback`),it={};class rt{static id=0;id=++rt.id;tt=this.id.toString();pattern;nt;et;st;Y;it;rt;ot;ut;ct;ht;dt;ft;wt;yt;bt;Nt;xt;St;vt;X;children={};constructor(t){const n=n=>t===n?this:lt(n),e=t.split("."),s=[],i=[],r=[],o={},l=[],u=[],a=[];let c="",h="",d=0;for(let t=0;t<e.length;t++)c+=e[t],"*"===e[t]&&(r.push(c),o[c]=d,l.push(n(c)),u.push(h),a.push(n(h)),d++),s.push(c),i.push(n(c)),h=c,c+=".";const f=r.length>0?r[r.length-1]:null,p=s.length>1?s[s.length-2]:null;this.pattern=t,this.nt=e,this.et=e[e.length-1],this.st=s,this.Y=new Set(s),this.it=i,this.rt=new Set(i),this.ot=r,this.ut=new Set(r),this.ht=o,this.ct=l,this.dt=new Set(l),this.ft=u,this.wt=new Set(u),this.yt=a,this.bt=new Set(a),this.Nt=f,this.xt=f?n(f):null,this.St=p,this.vt=p?n(p):null,this.X=d,this.vt&&(this.vt.children[this.et]=this)}}const ot=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","watch","unwatch","eval","arguments","let","var","const","class","function","null","true","false","new","return"]);function lt(t){let n;return n=it[t],void 0!==n?n:(ot.has(t)&&f(`getStructuredPathInfo: pattern is reserved word: ${t}`),it[t]=new rt(t))}class ut{#t;#g;#w;#y=null;#b;#s;get pattern(){return this.#g}get info(){return this.#w}get B(){return null===this.#y?null:this.#y.deref()??f("listIndex is null")}get state(){return this.#b}get filters(){return this.#s}get binding(){return this.#t}constructor(t,n,e,s){this.#t=t,this.#g=e,this.#w=lt(e),this.#b=n,this.#s=s}get value(){return this.#b[Y](this.info,this.B)}get u(){let t=this.value;for(let n=0;n<this.#s.length;n++)t=this.#s[n](t);return t}init(){if(this.info.X>0){const t=this.info.Nt??f("BindingState.init: wildcardLastParentPath is null"),n=this.binding.C.I?.find(t)??f("BindingState.init: loopContext is null");this.#y=n.$t}this.binding.$.It(this.info,this.B,this.binding)}l(t,n){t[tt](this.info,this.B,n)}}class at{#t;#N;#y=null;#b;#s;get pattern(){return f("Not implemented")}get info(){return f("Not implemented")}get B(){return null===this.#y?null:this.#y.deref()??f("listIndex is null")}get state(){return this.#b}get filters(){return this.#s}get binding(){return this.#t}constructor(t,n,e,s){this.#t=t;const i=Number(e.slice(1));isNaN(i)&&f("BindingStateIndex: pattern is not a number"),this.#N=i,this.#b=n,this.#s=s}get value(){return this.B?.index??f("listIndex is null")}get u(){let t=this.value;for(let n=0;n<this.#s.length;n++)t=this.#s[n](t);return t}init(){const t=(this.binding.C.I??f("BindingState.init: loopContext is null")).P();this.#y=t[this.#N-1].$t??f("BindingState.init: listIndexRef is null");const n=this.B??f("listIndex is null"),e=this.binding.$.Ct.get(n);void 0===e?this.binding.$.Ct.set(n,new Set([this.binding])):e.add(this.binding)}l(t,n){f("BindingStateIndex: assignValue is not implemented")}}const ct=new RegExp(/^\$\d+$/);function ht(t,n){return ct.test(t)?((t,n)=>(e,s,i)=>{const r=b(i,n);return new at(e,s,t,r)})(t,n):((t,n)=>(e,s,i)=>{const r=b(i,n);return new ut(e,s,t,r)})(t,n)}const dt={};function ft(t,n=(t=>t.constructor.name+"\t"+(t instanceof Comment?t.textContent?.[2]??"":""))(t)){return dt[n]??(dt[n]=(t=>t instanceof Comment&&":"===t.textContent?.[2]?"Text":t instanceof HTMLElement?"HTMLElement":t instanceof Comment&&"|"===t.textContent?.[2]?"Template":t instanceof SVGElement?"SVGElement":f(`Unknown NodeType: ${t.nodeType}`))(t))}const pt=t=>t.trim(),mt=t=>t.length>0,gt=new RegExp(/^#(.*)#$/),wt=t=>{const n=gt.exec(t);return n?decodeURIComponent(n[1]):t},yt=t=>{const[n,...e]=t.split(",").map(pt);return{name:n,options:e.map(wt)}},bt=t=>{const[n,...e]=t.split("|").map(pt);return{Pt:n,filters:e.map(yt)}},Nt=t=>t.split(";").map(pt).filter(mt).map((t=>(t=>{const[n,e=null]=t.split("@").map(pt),s=e?e.split(",").map(pt):[],[i,r]=n.split(":").map(pt),{Pt:o,filters:l}=bt(i),{Pt:u,filters:a}=bt(r);return{Bt:o,Et:u,Tt:l,kt:a,i:s}})(t))),xt={};const St=t=>{t.removeAttribute("data-bind")},vt={HTMLElement:St,SVGElement:St,Text:void 0,Z:void 0};const $t={Text:t=>{const n=document.createTextNode("");return t.parentNode?.replaceChild(n,t),n},HTMLElement:void 0,Z:void 0,SVGElement:void 0};class It{nodeType;Lt;Mt;Rt=new Map;constructor(t){this.nodeType=ft(t);const n=function(t,n){switch(t){case"Text":return"textContent:"+(n.textContent?.slice(3).trim()??"");case"HTMLElement":case"SVGElement":return n.getAttribute(P)??"";case"Template":{const t=n.textContent?.slice(3).trim();return(Mt(Number(t))??f(`Template not found: ${t}`)).getAttribute(P)??""}default:return""}}(this.nodeType,t);(function(t,n){vt[n]?.(t)})(t=function(t,n){return $t[n]?.(t)??t}(t,this.nodeType),this.nodeType),this.Lt=function(t){let n=[];for(;null!==t.parentNode;)n=[Array.from(t.parentNode.childNodes).indexOf(t),...n],t=t.parentNode;return n}(t),this.Mt=function(t){return""===t.trim()?[]:xt[t]??(xt[t]=Nt(t))}(n);for(let n=0;n<this.Mt.length;n++){const e=this.Mt[n],s={Ft:Q(t,e.Bt,e.Tt,e.i),At:ht(e.Et,e.kt)};this.Rt.set(e,s)}}}function Ct(t){const n=[],e=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,{acceptNode:t=>t instanceof Element?t.hasAttribute(P)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:function(t){return t instanceof Comment&&(0===t.textContent?.indexOf(B)||0===t.textContent?.indexOf(E))}(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;e.nextNode();)n.push(e.currentNode);return n}const Pt={},Bt={},Et={};function Tt(t){return Ct(t).map((t=>function(t){return new It(t)}(t)))}const kt={};function Lt(t,n,e){var s;return s=n.content,Array.from(s.childNodes).forEach((t=>{t.nodeType!==Node.TEXT_NODE||(t.nodeValue??"").trim()||s.removeChild(t)})),function(t,n,e=t){const s=Tt(n),i=Et[e]??(Et[e]=new Set),r=Bt[e]??(Bt[e]=new Set);for(let t=0;t<s.length;t++){const n=s[t];for(let t=0;t<n.Mt.length;t++){const e=n.Mt[t];i.add(e.Et),"for"===e.Bt&&r.add(e.Et)}}Pt[t]=s}(t,n.content,e),kt[t]=n,t}function Mt(t){return kt[t]??f(`getTemplateById: template not found: ${t}`)}class Rt{C;node;$;Vt;h;version;constructor(t,n,e,s,i){this.C=t,this.node=n,this.$=e,this.Vt=s(this,n,e.Ot),this.h=i(this,e.Ht,e.Wt)}get o(){return this.Vt.o}init(){this.Vt.init(),this.h.init()}L(){if(this.version!==this.$.zt.version)try{this.Vt.update()}finally{this.version=this.$.zt.version}}U(t,n){return this.h.l(t,n)}m(t){this.Vt.m(t)}}function Ft(t,n,e,s,i){return new Rt(t,n,e,s,i)}class At{#x;#w;#y;#u;constructor(t,n,e){this.#x=t??f("name is required"),this.#w=lt(this.#x),this.#y=new WeakRef(n),this.#u=e}get path(){return this.#x}get info(){return this.#w}get B(){return this.#y?.deref()??f("listIndex is null")}get $t(){return this.#y??f("listIndexRef is null")}R(t){this.#y=new WeakRef(t)}A(){this.#y=null}get jt(){return this.#u}#S;get qt(){if(void 0===this.#S){let t=this.jt;for(;null!==t;){if(null!==t.V&&t.V!==this){this.#S=t.V;break}t=t.Dt?.C??null}void 0===this.#S&&(this.#S=null)}return this.#S}#v={};find(t){let n=this.#v[t];if(void 0===n){let e=this;for(;null!==e&&e.path!==t;)e=e.qt;n=this.#v[t]=e}return n}_t(t){let n=this;for(;null!==n;)t(n),n=n.qt}P(){const t=[];return this._t((n=>{t.unshift(n)})),t}}function Vt(t){const n=[];for(let e=0;e<t.length;e++){const s=t[e];s.Vt.N?n.push(s):s.L()}for(let t=0;t<n.length;t++)n[t].L()}function Ot(t){const n=Mt(t)??f(`BindContent: template is not found: ${t}`),e=document.importNode(n.content,!0);if(Object.keys(Dn).length>0){const t=e.querySelectorAll(":not(:defined)");for(let n=0;n<t.length;n++){Gn(t[n].tagName.toLowerCase())}}return e}function Ht(t,n,e,s){const i=(t=>Pt[t])(n)??f("BindContent: data-bind is not set"),r=[];for(let n=0;n<i.length;n++){const l=i[n],u=(o=s,l.Lt.reduce(((t,n)=>t?.childNodes[n]??null),o)??f(`BindContent: node is not found: ${l.Lt}`));for(let n=0;n<l.Mt.length;n++){const s=l.Mt[n],i=l.Rt.get(s)??f(`BindContent: creator is not found: ${s}`),o=Ft(t,u,e,i.Ft,i.At);r.push(o)}}var o;return r}class Wt{V;Dt;childNodes;fragment;$;#l;get id(){return this.#l}get Gt(){return this.childNodes.length>0&&this.childNodes[0].parentNode!==this.fragment}get q(){return this.childNodes[0]??null}get _(){return this.childNodes[this.childNodes.length-1]??null}j(t){const n=this.Zt[this.Zt.length-1],e=this._;if(void 0!==n&&n.node===e&&n.o.size>0){const e=(Array.from(n.o).at(-1)??f("BindContent: childBindContent is not found")).j(t);if(null!==e)return e}return t!==e?.parentNode?null:e}#$;get I(){if(void 0===this.#$){let t=this;for(;null!==t&&null===t.V;)t=t.Dt?.C??null;this.#$=t?.V??null}return this.#$}constructor(t,n,e,s,i){this.Dt=t,this.#l=n,this.fragment=Ot(n),this.childNodes=Array.from(this.fragment.childNodes),this.$=e,this.V=null!==i?function(t,n,e){return new At(t,n,e)}(s,i,this):null,this.Zt=Ht(this,n,e,this.fragment)}mount(t){for(let n=0;n<this.childNodes.length;n++)t.appendChild(this.childNodes[n])}Ut(t,n){for(let e=0;e<this.childNodes.length;e++)t.insertBefore(this.childNodes[e],n)}k(t,n){const e=n?.nextSibling??null;for(let n=0;n<this.childNodes.length;n++)t.insertBefore(this.childNodes[n],e)}unmount(){const t=this.childNodes[0]?.parentElement??null;if(null!==t)for(let n=0;n<this.childNodes.length;n++)t.removeChild(this.childNodes[n])}Zt=[];L(){Vt(this.Zt)}init(){this.Zt.forEach((t=>t.init()))}R(t){null==this.V&&f("BindContent: loopContext is null"),this.V.R(t),this.init()}}function zt(t,n,e,s,i){const r=new Wt(t,n,e,s,i);return r.init(),r}function jt(t,n){return`${t.pattern}@${n}`}const qt={};class Dt{$;Jt;Kt=new Set;constructor(t,n){this.$=t,this.Jt=n}Qt(t,n,e){const s=jt(t,n);if(this.Kt.has(s))return;this.Kt.add(s),e(this.Jt,t,n);const i=this.$.Xt.get(t)??[];for(const t of i){const s="structured"===t.type?n:t.type;this.Qt(t.info,s,e)}}_t(t){this.Qt(this.Jt.info,"structured",t)}}function _t(t,n){return new Dt(t,n)}class Gt{static id=0;id=++Gt.id;tt=this.id.toString();#I=null;get Yt(){return this.#I}index;get tn(){const t=this.Yt?.tn??[];return t.push(this.index),t}get position(){return(this.Yt?.position??-1)+1}get length(){return(this.Yt?.length??0)+1}constructor(t,n){this.#I=t,this.index=n}truncate(t){let n=this;for(;null!==n;){if(n.position<t)return n;n=n.Yt}return null}add(t){return new Gt(this,t)}*nn(){yield this,null!==this.Yt&&(yield*this.Yt.nn())}*iterator(){null!==this.Yt&&(yield*this.Yt.iterator()),yield this}toString(){const t=this.Yt?.toString();return null!==t?t+","+this.index.toString():this.index.toString()}#C={};at(t){const n=this.#C[t];if(void 0!==n)return n?n.deref()??null:null;let e=null;if(t>=0){let n=this.length-t-1;for(e=this;n>0&&null!==e;)e=e.Yt,n--}else{let n,s;for(t=-t-1,n=this.nn();t>=0;)s=n.next(),t--;e=s?.value??null}return this.#C[t]=e?new WeakRef(e):null,e}}function Zt(t,n){return new Gt(t,n)}function Ut(t,n,e,s){const i=e?.length??0;if(n.X===i)s(n,e);else{const r=n.yt[i]??f("Invalid state property info"),o=t.W(r,e);for(const e of o??[])Ut(t,n,e,s)}}function Jt(t,n,e,s){Ut(t,n,e,s)}function Kt(t,n){return null==n?t.tt:t.tt+"#"+n.tt}const Qt=new Set;function Xt(t,n,e,s){const i=t.D(n,e)??[];if(i===s)return;const r=new Set,o=t.W(n,e)??Qt,l=Map.groupBy(o,(t=>i[t.index]));for(let n=0;n<s.length;n++){let i=l.get(s[n])?.shift()??Zt(e,n);i.index!==n&&(i.index=n,t.zt.en(i)),r.add(i)}t.sn(n,e,r),t.G(n,e,s.slice(0))}function Yt(t,n,s,i,r){for(const{info:o,B:l}of t){if(e.optimizeListElements&&n.rn.has(o))continue;const t=_t(n,{info:o,B:l}),u=e.optimizeList&&n.ln.has(o);t._t(((t,e,o)=>{if(u&&"structured"===o&&t.info!==e&&e.rt.has(t.info))return;const l=Array.from(t.info.dt.intersection(e.dt)),a=(l.at(-1)?.X??0)-1,c=a>=0?t.B?.at(a)??null:null;Jt(n,e,c,((t,e)=>{const o=Kt(t,e);if(i.has(o))return;let l=r.get(t);if(l||(l=new Set,r.set(t,l)),l.add(e),n.un(t)&&(i.add(o),n.ln.has(t))){const i=s[o]??n.Ht[Y](t,e);Xt(n,t,e,i)}}))}))}}class tn{an=new Set;cn={};$;#P=0;constructor(t){this.$=t}get version(){return this.#P}hn(t){queueMicrotask(t)}dn(t,n,e){const s=Kt(t,n);this.an.add({info:t,B:n}),this.cn[s]=e,this.fn()}en(t){this.an.add(t),this.fn()}#B=!1;fn(){if(this.#B)return;this.#B=!0;const t=this.$;queueMicrotask((()=>{try{const{Zt:n,pn:e,properties:s}=this.mn();for(const t of e)t.binding.Vt.p(t.gn,t.values);if(n.length>0&&this.L(n),t.wn.size>0)for(const n of t.wn){const e=t.K.get(n)??new Set;for(const t of e)t.m(s)}}finally{this.#B=!1}}))}mn(){const t=[],n=[],e=[],s=this.$,i=s.wn.size>0;for(;this.an.size>0;){const r=Array.from(this.an.values());this.an.clear();const o=[],l=[],u=new Map;for(let t=0;t<r.length;t++){const n=r[t];if("index"in n){const t=s.Ct.get(n)??[];o.push(...t)}else if(l.push(n),s.rn.has(n.info)){const t=n.info.vt??f("info is null"),e=n.B?.at(-2)??null,s={info:t,B:e},i=Kt(t,e);let r=u.get(i);r||(r={yn:s,gn:[],values:[]},u.set(i,r));const o=Kt(n.info,n.B),l=this.cn[o]??null;r.values?.push(l),r.gn?.push(n.B)}}const a=new Set,c=new Map;Yt(l,s,this.cn,a,c);for(const[n,e]of u){const n=e.yn?.info??f("parentInfo is null"),i=e.yn?.B??null,r=s.bn(n,i);for(const n of r){if(!n.Vt.S)continue;const s=Object.assign({},e,{binding:n});t.push(s)}}for(const[t,r]of c.entries())for(const o of r){const r=s.bn(t,o);n.push(...r??[]),i&&e.push({info:t,B:o})}n.push(...o)}return this.cn={},{Zt:n,pn:t,properties:e}}L(t){this.#P++,this.$.Ht[nt]((()=>Vt(t)))}}function nn(t,n,e){if(n.enableShadowDom)if(null===n.Nn||function(t){try{return"function"==typeof document.createElement(t).attachShadow}catch{return!1}}(n.Nn)){t.attachShadow({mode:"open"}).adoptedStyleSheets=[e]}else f(`ComponentEngine: Shadow DOM not supported for builtin components that extend ${n.Nn}`);else{const n=function(t){let n=t;for(;n;){if(n instanceof ShadowRoot)return n;n=n.parentNode}}(t.parentNode)||document,s=n.adoptedStyleSheets;s.includes(e)||(n.adoptedStyleSheets=[...s,e])}}const en=new Set;function sn(t,n,e,s,i){const r=t.D(e,s)??[];if(r===i)return;const o=new Set,l=t.W(e,s)??en,u=Map.groupBy(l,(t=>r[t.index]));for(let n=0;n<i.length;n++){let e=u.get(i[n])?.shift()??Zt(s,n);e.index!==n&&(e.index=n,t.zt.en(e)),o.add(e)}t.sn(e,s,o),t.G(e,s,i.slice(0));const a=e.pattern+".*";for(const e of n)if(a===e.Nt)for(const s of o){const i=t.Ht[Y](e,s);sn(t,n,e,s,i??[])}}function rn(t,n,e,s){if(t.ln,!t.ln.has(n))return;const i=s??[];sn(t,t.ln,n,e,i)}const on={};class ln{static id=0;id=++ln.id;name;elements;xn;X;Sn;vn;info;constructor(t){const n=t.split("."),e=n.slice(),s=[];let i=0,r=0,o="",l=0,u="none",a=[];for(let t=0;t<n.length;t++){const u=n[t];if("*"===u)e[t]="*",a.push(null),i++,l++;else{const n=Number(u);Number.isNaN(n)||(e[t]="*",a.push(n),r++,l++)}o+=u,s.push(o),o+=t<n.length-1?".":""}const c=lt(e.join("."));(i>0||r>0)&&(u=i===l?"context":r===l?"all":"partial"),this.name=t,this.elements=n,this.xn=s,this.X=l,this.Sn=u,this.vn=a,this.info=c}}function un(t){return on[t]??(on[t]=new ln(t))}function an(t,n){const e=t.$n[t.In];if(null==e)return null;const s=e.ht[n];if(s>=0){const n=t.Cn[t.In];return void 0===n?null:n?.at(s)??null}return null}function cn(t,n,e){switch(t.Sn){case"none":return null;case"context":return an(e,t.info.Nt??f("lastWildcardPath is null"))??f(`ListIndex not found: ${t.info.pattern}`);case"all":let n=null;for(let s=0;s<t.info.X;s++){const i=t.info.yt[s]??f("wildcardParentPattern is null");n=Array.from(e.$.W(i,n)??[])[t.vn[s]??f("wildcardIndex is null")]??f(`ListIndex not found: ${i.pattern}`)}return n;case"partial":f(`Partial wildcard type is not supported yet: ${t.info.pattern}`)}}function hn(t,n,e,s){t.In++,t.In>=t.$n.length&&(t.$n.push(null),t.Cn.push(null)),t.$n[t.In]=n,t.Cn[t.In]=e;try{return s()}finally{t.$n[t.In]=null,t.Cn[t.In]=null,t.In--}}function dn(t,n,e){const s=n.Pn[n.Bn]??null;null!=s&&n.$.En.has(s.pattern)&&n.$.Tn(s,t,"reference"),n.Bn++,n.Bn>=n.Pn.length&&n.Pn.push(null),n.Pn[n.Bn]=t,n.kn=n.Pn[n.Bn]??null;try{return e()}finally{n.Pn[n.Bn]=null,n.Bn--,n.kn=n.Pn[n.Bn]??null}}function fn(t,n,e,s,i){return dn(n,i,(()=>function(t,n,e,s,i){let r,o="";if(i.Ln){const t=null===e?n.tt:n.tt+"#"+e.tt,s=i.cache[t];if(void 0!==s)return s;if(t in i.cache)return;o=t}try{if(i.$.Mn.startsWith(n)&&0===i.$.Rn.intersection(n.Y).size)return r=i.$.Mn.get(n,e);if(n.pattern in t)return r=hn(i,n,e,(()=>Reflect.get(t,n.pattern,s)));{const o=n.vt??f("propRef.stateProp.parentInfo is undefined"),l=o.X<n.X?e?.Yt??null:e,u=fn(t,o,l,s,i),a=n.et;if("*"===a){const t=e?.index??f("propRef.listIndex?.index is undefined");return r=Reflect.get(u,t)}return r=Reflect.get(u,a)}}finally{i.Ln&&!(o in i.cache)&&(i.cache[o]=r)}}(t,n,e,s,i)))}function pn(t,n,e,s){return(n,i,r)=>{const o=lt(n);null!=s.kn&&s.$.En.has(s.kn.pattern)&&s.$.Tn(s.kn,o,"reference");let l=null;for(let t=0;t<o.yt.length;t++){const n=o.yt[t]??f("wildcardParentPath is null");l=Array.from(s.$.W(n,l)??[])[i[t]??f("index is null")]??f(`ListIndex not found: ${n.pattern}`)}if(void 0===r)return fn(t,o,l,e,s);f(`Cannot set value on a readonly proxy: ${n}`)}}function mn(t,n,e,s){return t=>{const n=lt(t);null!=s.kn&&s.$.En.has(s.kn.pattern)&&s.$.Tn(s.kn,n,"reference")}}const gn={$1:0,$2:1,$3:2,$4:3,$5:4,$6:5,$7:6,$8:7,$9:8};function wn(t,n,e,s){const i=gn[n];if(void 0!==i){const t=s.Cn[s.In];return t?.at(i)?.index??f(`ListIndex not found: ${n.toString()}`)}if("string"==typeof n){if("$"===n[0])switch(n){case"$resolve":return pn(t,0,e,s);case"$getAll":return function(t,n,e,s){const i=pn(t,0,e,s);return(t,n)=>{const e=lt(t);if(null!=s.kn&&s.$.En.has(s.kn.pattern)&&s.$.Tn(s.kn,e,"reference"),void 0===n){for(let t=0;t<e.ct.length;t++){const i=e.ct[t]??f("wildcardPattern is null"),r=an(s,i.pattern);if(r){n=r.tn;break}}void 0===n&&(n=[])}const r=(t,n,e,i,o,l,u)=>{const a=t[n]??null;if(null===a)return void u.push(l);const c=s.$.W(a,e)??f(`ListIndex not found: ${a.pattern}`),h=Array.from(c),d=i[o]??null;if(null===d)for(let e=0;e<h.length;e++){const s=h[e];r(t,n+1,s,i,o+1,l.concat(s.index),u)}else{const e=h[d]??f(`ListIndex not found: ${a.pattern}`);n+1<t.length&&r(t,n+1,e,i,o+1,l.concat(e.index),u)}},o=[];r(e.yt,0,null,n,0,[],o);const l=[];for(let t=0;t<o.length;t++)l.push(i(e.pattern,o[t]));return l}}(t,0,e,s);case"$trackDependency":return mn(0,0,0,s);case"$navigate":return t=>Xn()?.navigate(t);case"$component":return s.$.J}const i=un(n),r=cn(i,0,s);return fn(t,i.info,r,e,s)}if("symbol"==typeof n)switch(n){case Y:return(n,i)=>fn(t,n,i,e,s);case nt:return t=>function(t,n){t.Ln=!0,t.cache={};try{n()}finally{t.Ln=!1}}(s,t);default:return Reflect.get(t,n,e)}}let yn=class{$;Ln=!1;cache={};kn=null;Pn=Array(32).fill(null);Bn=-1;$n=Array(32).fill(null);Cn=Array(32).fill(null);In=-1;V=null;constructor(t){this.$=t}get(t,n,e){return wn(t,n,e,this)}set(t,n,e,s){f(`Cannot set property ${String(n)} of readonly state.`)}};function bn(t,n,e,s,i){return dn(n,i,(()=>function(t,n,e,s,i){if(i.$.Mn.startsWith(n)&&0===i.$.Rn.intersection(n.Y).size)return i.$.Mn.get(n,e);if(n.pattern in t)return hn(i,n,e,(()=>Reflect.get(t,n.pattern,s)));{const r=n.vt??f("propRef.stateProp.parentInfo is undefined"),o=r.X<n.X?e?.Yt??null:e,l=bn(t,r,o,s,i),u=n.et;if("*"===u){const t=e?.index??f("propRef.listIndex?.index is undefined");return Reflect.get(l,t)}return Reflect.get(l,u)}}(t,n,e,s,i)))}function Nn(t,n,e,s,i,r){try{if(r.$.Mn.startsWith(n)&&0===r.$.Fn.intersection(n.Y).size)return r.$.Mn.set(n,e,s);if(n.pattern in t)return hn(r,n,e,(()=>Reflect.set(t,n.pattern,s,i)));{const o=n.vt??f("propRef.stateProp.parentInfo is undefined"),l=o.X<n.X?e?.Yt??null:e,u=bn(t,o,l,i,r),a=n.et;if("*"===a){const t=e?.index??f("propRef.listIndex?.index is undefined");return Reflect.set(u,t,s)}return Reflect.set(u,a,s)}}finally{r.$.zt.dn(n,e,s)}}function xn(t,n,e,s){return(n,i,r)=>{const o=lt(n);null!=s.kn&&s.$.En.has(s.kn.pattern)&&s.$.Tn(s.kn,o,"reference");let l=null;for(let t=0;t<o.yt.length;t++){const n=o.yt[t]??f("wildcardParentPath is null");l=Array.from(s.$.W(n,l)??[])[i[t]??f("index is null")]??f(`ListIndex not found: ${n.pattern}`)}return void 0===r?bn(t,o,l,e,s):Nn(t,o,l,r,e,s)}}function Sn(t,n,e,s){const i=gn[n];if(void 0!==i){const t=s.Cn[s.In];return t?.at(i)?.index??f(`ListIndex not found: ${n.toString()}`)}if("string"==typeof n){if("$"===n[0])switch(n){case"$resolve":return xn(t,0,e,s);case"$getAll":return function(t,n,e,s){const i=xn(t,0,e,s);return(t,n)=>{const e=lt(t);if(null!=s.kn&&s.$.En.has(s.kn.pattern)&&s.$.Tn(s.kn,e,"reference"),void 0===n){for(let t=0;t<e.ct.length;t++){const i=e.ct[t]??f("wildcardPattern is null"),r=an(s,i.pattern);if(r){n=r.tn;break}}void 0===n&&(n=[])}const r=(t,n,e,i,o,l,u)=>{const a=t[n]??null;if(null===a)return void u.push(l);const c=s.$.W(a,e)??f(`ListIndex not found: ${a.pattern}`),h=Array.from(c),d=i[o]??null;if(null===d)for(let e=0;e<h.length;e++){const s=h[e];r(t,n+1,s,i,o+1,l.concat(s.index),u)}else{const e=h[d]??f(`ListIndex not found: ${a.pattern}`);n+1<t.length&&r(t,n+1,e,i,o+1,l.concat(e.index),u)}},o=[];r(e.yt,0,null,n,0,[],o);const l=[];for(let t=0;t<o.length;t++)l.push(i(e.pattern,o[t]));return l}}(t,0,e,s);case"$trackDependency":return mn(0,0,0,s);case"$navigate":return t=>Xn()?.navigate(t);case"$component":return s.$.J}const i=un(n),r=cn(i,0,s);return bn(t,i.info,r,e,s)}if("symbol"==typeof n)switch(n){case Y:return(n,i)=>bn(t,n,i,e,s);case tt:return(n,i,r)=>Nn(t,n,i,r,e,s);case et:return()=>function(t,n,e){return async()=>{const n=Reflect.get(t,"$connectedCallback");"function"==typeof n&&await n.call(t,e)}}(t,0,e);case st:return()=>function(t,n,e){return async()=>{const n=Reflect.get(t,"$disconnectedCallback");"function"==typeof n&&await n.call(t,e)}}(t,0,e);default:return Reflect.get(t,n,e)}}class vn{$;kn=null;Pn=Array(32).fill(null);Bn=-1;$n=Array(32).fill(null);Cn=Array(32).fill(null);In=-1;V=null;constructor(t){this.$=t}get(t,n,e){return Sn(t,n,e,this)}set(t,n,e,s){return function(t,n,e,s,i){if("string"==typeof n){const r=un(n),o=cn(r,0,i);return Nn(t,r.info,o,e,s,i)}return Reflect.set(t,n,e,s)}(t,n,e,s,this)}}async function $n(t,n,e=null,s){const i=new vn(t),r=new Proxy(n,i);return async function(t,n,e){t.V&&f("already in loop context"),t.V=n;try{n?await async function(t,n,e,s){t.In++,t.In>=t.$n.length&&(t.$n.push(null),t.Cn.push(null)),t.$n[t.In]=n,t.Cn[t.In]=e;try{await s()}finally{t.$n[t.In]=null,t.Cn[t.In]=null,t.In--}}(t,n.info,n.B,e):await e()}finally{t.V=null}}(i,e,(async()=>{await s(r)}))}class In{An=new Set;Vn=new Set;On=new Map;Hn=new Map;Wn=new Map;zn=new Map;jn(t){const n=t.h.pattern,e=t.Vt.t;if(this.On.has(n))throw new Error(`Parent path "${n}" already has a child path.`);if(this.Hn.has(e))throw new Error(`Child path "${e}" already has a parent path.`);this.On.set(n,e),this.Hn.set(e,n),this.An.add(n),this.Vn.add(e),this.Wn.set(n,t),this.zn.set(e,t)}qn(t){return this.On.get(t)}Dn(t){return this.Hn.get(t)}_n(t){const n=lt(t).Y.intersection(this.Vn);0===n.size&&f(`No parent path found for child path "${t}".`);const e=Array.from(n),s=e[e.length-1],i=t.slice(s.length),r=this.Hn.get(s);return void 0===r&&f(`No parent path found for child path "${t}".`),r+i}Gn(t){const n=lt(t).Y.intersection(this.An);0===n.size&&f(`No child path found for parent path "${t}".`);const e=Array.from(n),s=e[e.length-1],i=t.slice(s.length),r=this.On.get(s);return void 0===r&&f(`No child path found for parent path "${t}".`),r+i}Zn(t){if(0===this.Vn.size)return null;const n=t.Y.intersection(this.Vn);if(0===n.size)return null;{const t=Array.from(n);return t[t.length-1]}}bind(t,n){const e=t.Un(n);for(const t of e??[])this.jn(t)}}class Cn{Jn;$;constructor(t,n){this.Jn=n,this.$=t}Kn(t){this.$.T(null,(async n=>{for(const[n,e]of Object.entries(t)){const t=lt(n);this.$.Qn(t,null,e)}}))}m(t){for(const n of t)try{const t=lt(this.Jn.Gn(n.info.pattern)),e=n.B,s=this.$.getPropertyValue(t,e);this.$.zt.dn(t,e,s)}catch(t){}}get(t,n,e){return n===D?this.Kn.bind(this):n===_?this.m.bind(this):"string"==typeof n?this.$.getPropertyValue(lt(n),null):void f(`Property "${String(n)}" is not supported in ComponentStateInput.`)}set(t,n,e,s){if("string"==typeof n)return this.$.Qn(lt(n),null,e),!0;f(`Property "${String(n)}" is not supported in ComponentStateInput.`)}}class Pn{binding;constructor(t){this.binding=t}get(t,n){const e=this.binding.Zn(t);null===e&&f(`No child path found for path "${t.toString()}".`);const s=this.binding.zn.get(e);void 0===s&&f(`No binding found for child path "${e}".`);const i=lt(this.binding._n(t.pattern));return s.$.Ht[Y](i,n??s.h.B)}set(t,n,e){const s=this.binding.Zn(t);null===s&&f(`No child path found for path "${t.toString()}".`);const i=this.binding.zn.get(s);void 0===i&&f(`No binding found for child path "${s}".`);const r=lt(this.binding._n(t.pattern));return i.$.T(null,(async t=>{t[tt](r,n??i.h.B,e)})),!0}startsWith(t){return null!==this.binding.Zn(t)}W(t,n){const e=this.binding.Zn(t);null===e&&f(`No child path found for path "${t.toString()}".`);const s=this.binding.zn.get(e);void 0===s&&f(`No binding found for child path "${e}".`);const i=lt(this.binding._n(t.pattern));return s.$.W(i,n)}}class Bn{type="autonomous";config;Xn;styleSheet;Yn;state;Ht;zt;Ot;Wt;#u=null;get jt(){return null===this.#u&&f("bindContent is not initialized yet"),this.#u}te=HTMLElement;J;En;Rn;Fn;ln=new Set;rn=new Set;Ct=new WeakMap;Xt=new Map;K=new WeakMap;wn=new Set;#E=Promise.withResolvers();#T=function(){return new In}();ee;Mn;#k=null;#L=null;#M=!1;constructor(t,n){this.config=t,this.config.Nn&&(this.type="builtin");const e=n.constructor;var s,i,r;this.Xn=e.Xn,this.styleSheet=e.styleSheet,this.Yn=e.Yn,this.state=new this.Yn,this.Ht=(s=this,i=this.state,new Proxy(i,new yn(s))),this.zt=function(t){return new tn(t)}(this),this.Ot=e.Ot,this.Wt=e.Wt,this.J=n,this.En=e.En,this.Rn=e.Rn,this.Fn=e.Fn,this.ee=function(t,n){const e=new Cn(t,n);return new Proxy({},e)}(this,this.#T),this.Mn=(r=this.#T,new Pn(r));const o=t=>{const n=t.vt;null!==n&&(this.Tn(t,n,"structured"),o(n))};for(const t of e.xn){const n=lt(t);o(n)}for(const t of e.se)this.ln.add(lt(t)),this.rn.add(lt(t+".*"));for(const t of this.Yn.ie??[])this.ln.add(lt(t)),this.rn.add(lt(t+".*"))}re(){const t=this.J.constructor;for(const t of this.ln){if(t.X>0)continue;rn(this,t,null,this.Ht[Y](t,null))}this.#u=zt(null,t.id,this,null,null)}get oe(){return this.#E}async connectedCallback(){if(await(this.J.ue?.oe.promise),this.J.dataset.state)try{const t=JSON.parse(this.J.dataset.state);this.ee[D](t)}catch(t){f("Failed to parse state from dataset")}const t=this.J.ue;if(t&&(t.ae(this.J),this.#T.bind(t,this.J)),this.config.ce)nn(this.J,this.config,this.styleSheet);else{this.#L=this.J.parentNode,this.#k=document.createComment("Structive block placeholder");try{this.#M=!0,this.J.replaceWith(this.#k)}finally{this.#M=!1}}this.Ht[nt]((()=>{this.jt.L()})),await this.T(null,(async t=>{await t[et]()})),queueMicrotask((()=>{if(this.config.ce)this.jt.mount(this.J.shadowRoot??this.J);else{const t=this.#L??f("Block parent node is not set");this.jt.k(t,this.#k)}this.#E.resolve()}))}async disconnectedCallback(){this.#M||(await this.T(null,(async t=>{await t[st]()})),this.J.ue?.he(this.J),this.config.ce||(this.#k?.remove(),this.#k=null,this.#L=null))}#R={};#F={};de(){return{list:null,fe:null,Zt:[]}}pe(t,n){if(null===n){let n=this.#F[t.id];return void 0===n&&(n=this.de(),this.#F[t.id]=n),n}{let e=this.#R[t.id];void 0===e&&(e=new WeakMap,this.#R[t.id]=e);let s=e.get(n);return void 0===s&&(s=this.de(),e.set(n,s)),s}}It(t,n,e){this.pe(t,n).Zt.push(e)}sn(t,n,e){this.pe(t,n).fe=e}G(t,n,e){this.pe(t,n).list=e}bn(t,n){return this.pe(t,n).Zt}un(t){return void 0!==this.#F[t.id]||void 0!==this.#R[t.id]}W(t,n){if(this.Mn.startsWith(t))return this.Mn.W(t,n);return this.pe(t,n).fe}D(t,n){return this.pe(t,n).list}Tn(t,n,e){let s=this.Xt.get(n);void 0===s&&(s=new Set,this.Xt.set(n,s));const i=function(t,n){const e=jt(t,n);return qt[e]??(qt[e]={info:t,type:n})}(t,e);s.add(i)}getPropertyValue(t,n){return this.Ht[Y](t,n)}Qn(t,n,e){this.zt.hn((()=>{this.T(null,(async s=>{s[tt](t,n,e)}))}))}async T(t,n){return $n(this,this.state,t,n)}ae(t){this.wn.add(t)}he(t){this.wn.delete(t)}}const En=/\{\{([^\}]+)\}\}/g,Tn=new Set(["if","for","endif","endfor","elseif","else"]);const kn="http://www.w3.org/2000/svg";function Ln(t,n,e=t){if(n.parentNode?.replaceChild(document.createComment(`${E}${t}`),n),n.namespaceURI===kn){const t=document.createElement("template");for(let e of Array.from(n.childNodes))t.content.appendChild(e);const e=n.getAttribute(P);t.setAttribute(P,e??""),n=t}return n.content.querySelectorAll("template").forEach((t=>{Ln(d(),t,e)})),Lt(t,n,e),t}function Mn(t,n){const e=document.createElement("template");e.dataset.id=t.toString(),e.innerHTML=function(t){const n=[];return t.replaceAll(En,((t,e)=>{e=e.trim();const[s]=e.split(":");if(!Tn.has(s))return`\x3c!--${B}${e}--\x3e`;const i=e.slice(s.length+1).trim(),r={type:s,me:e,we:i};if("if"===s||"for"===s)return n.push(r),`<template data-bind="${e}">`;if("endif"===s){const t=[];for(;;){const e=n.pop()??f("replaceMustacheToTemplateOrEmbed: endif without if");if("if"===e.type){t.push("</template>");break}"elseif"===e.type?t.push("</template>"):f("replaceMustacheToTemplateOrEmbed: endif without if")}return t.join("")}if("endfor"===s){if("for"===(n.pop()??f("replaceMustacheToTemplateOrEmbed: endif without if")).type)return"</template>";f("replaceMustacheToTemplateOrEmbed: endfor without for")}else if("elseif"===s){const t=n.at(-1)??f("replaceMustacheToTemplateOrEmbed: elseif without if");if("if"===t.type||"elseif"===t.type)return n.push(r),`</template><template data-bind="if:${t.we}|not"><template data-bind="if:${i}">`;f("replaceMustacheToTemplateOrEmbed: elseif without if")}else if("else"===s){const t=n.at(-1)??f("replaceMustacheToTemplateOrEmbed: else without if");if("if"===t.type)return`</template><template data-bind="if:${t.we}|not">`;f("replaceMustacheToTemplateOrEmbed: else without if")}else f("replaceMustacheToTemplateOrEmbed: unknown type")}))}(n),Ln(t,e)}const Rn=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/,Fn=/^[a-zA-Z_$][0-9a-zA-Z_$]*(\.[a-zA-Z_$][0-9a-zA-Z_$]*|\.\*)*$/;function An(t,n){const e=new Set(t.st).intersection(n);let s=-1,i="";for(const t of e){const n=t.split(".");1!==n.length&&(n.length>s&&(s=n.length,i=t))}if(i.length>0){if(!Fn.test(i))throw new Error(`Invalid path: ${i}`);const n=lt(i),e=[];let s=n.X;for(let i=n.nt.length;i<t.nt.length;i++){const n=t.nt[i];if("*"===n)e.push("[this.$"+(s+1)+"]"),s++;else{if(!Rn.test(n))throw new Error(`Invalid segment name: ${n}`);e.push("."+n)}}const r=e.join("");return{get:new Function("",`return this["${i}"]${r};`),set:new Function("value",`this["${i}"]${r} = value;`)}}{const n=[];let e=0;for(const s of t.nt)if("*"===s)n.push("[this.$"+(e+1)+"]"),e++;else{if(!Rn.test(s))throw new Error(`Invalid segment name: ${s}`);n.push((n.length>0?".":"")+s)}const s=n.join("");return{get:new Function("",`return this.${s};`),set:new Function("value",`this.${s} = value;`)}}}function Vn(t){const s=function(t){const e=n();return{ce:void 0===t.ce||t.ce,enableShadowDom:t.enableShadowDom??e.enableShadowDom,Nn:t.Nn??null}}(t.Yn.ye??{}),i=d(),{be:r,Ne:o,Yn:l}=t,u=Object.assign({},c),h=Object.assign({},a);l.xe=!0,Mn(i,r),g(i,o),function(t,n){p[t]=n}(i,l);const w=function(t){return t?document.createElement(t).constructor:HTMLElement}(s.Nn),y=s.Nn;return class extends w{#A;constructor(){super(),this.#A=function(t,n){return new Bn(t,n)}(s,this),this.#A.re()}connectedCallback(){this.#A.connectedCallback()}disconnectedCallback(){this.#A.disconnectedCallback()}#V;get ue(){var t;return void 0===this.#V&&(this.#V=(t=this,G.get(t)??null)),this.#V}get state(){return this.#A.ee}get Se(){return this.#A.Yn.xe??!1}get oe(){return this.#A.oe}Un(t){return this.#A.K.get(t)??null}ae(t){this.#A.ae(t)}he(t){this.#A.he(t)}static define(t){y?customElements.define(t,this,{Nn:y}):customElements.define(t,this)}static get id(){return i}static#O=r;static get be(){return this.#O}static set be(t){this.#O=t,Mn(this.id,t),this.#H=null}static#W=o;static get Ne(){return this.#W}static set Ne(t){this.#W=t,g(this.id,t),this.#z=null}static#H=null;static get Xn(){return this.#H||(this.#H=Mt(this.id)),this.#H}static#z=null;static get styleSheet(){return this.#z||(this.#z=function(t){return m[t]??f(`getStyleSheetById: stylesheet not found: ${t}`)}(this.id)),this.#z}static#j=null;static get Yn(){return this.#j||(this.#j=function(t){return p[t]??f(`getStateClassById: stateClass not found: ${t}`)}(this.id)),this.#j}static#q=u;static get Ot(){return this.#q}static#D=h;static get Wt(){return this.#D}static get se(){return(t=>Bt[t]??[])(this.id)}static get xn(){return(t=>Et[t]??[])(this.id)}static#_=new Set;static get Rn(){return this.#_}static#G=new Set;static get Fn(){return this.#G}static#Z=null;static get En(){if(null===this.#Z){this.#Z=new Set;let t=this.Yn.prototype;for(;t&&t!==Object.prototype;){const n=Object.getOwnPropertyDescriptors(t);if(n)for(const[t,e]of Object.entries(n)){const n=void 0!==e.get,s=void 0!==e.set;n&&(this.#_.add(t),s?this.#G?.add(t):this.#Z.add(t))}t=Object.getPrototypeOf(t)}if(e.optimizeAccessor)for(const t of this.xn){const n=lt(t);if(1===n.nt.length)continue;if(this.#_.has(t))continue;const e=An(n,this.#_);Object.defineProperty(this.Yn.prototype,t,{get:e.get,set:e.set,enumerable:!0,configurable:!0})}}return this.#Z}}}function On(t){return t.replaceAll(/<!--\{\{([^\}]+)\}\}-->/g,((t,n)=>`{{${n}}}`))}async function Hn(t){const n=await fetch(import.meta.resolve(t));return async function(t){const n=document.createElement("template");n.innerHTML=function(t){return t.replaceAll(/\{\{([^\}]+)\}\}/g,((t,n)=>`\x3c!--{{${n}}}--\x3e`))}(t);const e=n.content.querySelector("template");e?.remove();const s=n.content.querySelector("script[type=module]"),i=btoa(String.fromCodePoint(...(new TextEncoder).encode(s.text))),r=s?await import("data:application/javascript;base64,"+i):{};s?.remove();const o=n.content.querySelector("style");o?.remove();const l=r.default??class{};return{text:t,be:On(e?.innerHTML??"").trim(),Ne:o?.textContent??"",Yn:l}}(await n.text())}function Wn(t,n){n.define(t)}const zn="@routes/",jn="@components/",qn="#lazy",Dn={};async function _n(){const t=function(){const t={};return document.querySelectorAll("script[type='importmap']").forEach((n=>{const e=JSON.parse(n.innerHTML);e.imports&&(t.imports=Object.assign(t.imports||{},e.imports))})),t}();if(t.imports){const n=new Map;for(const[e,s]of Object.entries(t.imports)){let t,s;if(e.startsWith(zn)){s=e.endsWith(qn);const n=e.slice(7,s?-5:void 0);t="routes"+n.replace(/:[^\s/]+/g,"").replace(/\//g,"-"),Qn(t,"/root"===n?"/":n)}e.startsWith(jn)&&(s=e.endsWith(qn),t=e.slice(12,s?-5:void 0)),t&&(s?Dn[t]=e:n.set(t,e))}for(const[t,e]of n.entries()){Wn(t,Vn(await Hn(e)))}}}function Gn(t){const n=Dn[t];n?(delete Dn[t],queueMicrotask((async()=>{const e=Vn(await Hn(n));Wn(t,e)}))):console.warn(`loadLazyLoadComponent: alias not found for tagName: ${t}`)}const Zn="routes:",Un=[];let Jn=null;class Kn extends HTMLElement{ve=window.location.pathname;$e=window.location.pathname.split("/").pop()||"";Ie=document.querySelector("base")?.href.replace(window.location.origin,"")||"/";Ce;constructor(){super(),this.Ce=this.Pe.bind(this)}connectedCallback(){Jn=this,this.innerHTML='<slot name="content"></slot>',window.addEventListener("popstate",this.Ce),window.dispatchEvent(new Event("popstate"))}disconnectedCallback(){window.removeEventListener("popstate",this.Ce),Jn=null}Pe(t){t.preventDefault(),this.L()}navigate(t){const n="/"===t[0]?this.Ie+t.slice(1):t;history.pushState({},"",n),this.L()}L(){Array.from(this.childNodes).filter((t=>"content"===t.getAttribute?.("slot"))).forEach((t=>this.removeChild(t)));const t=window.location.pathname.split("/");t.at(-1)===this.$e&&(t[t.length-1]="");const n=t.join("/").replace(this.Ie,""),e="/"!==n[0]?"/"+n:n;let s,i={};for(const[t,n]of Un){const r=new RegExp("^"+t.replace(/:[^\s/]+/g,"([^/]+)")+"$");if(r.test(e)){s=n;const o=e.match(r);if(o){(t.match(/:[^\s/]+/g)||[]).forEach(((t,n)=>{i[t.substring(1)]=o[n+1]}))}break}}if(s){const t=document.createElement(s);t.setAttribute("data-state",JSON.stringify(i)),t.setAttribute("slot","content"),this.appendChild(t),function(t){return Dn.hasOwnProperty(t)}(s)&&Gn(s)}else{const t=document.createElement("h1");t.setAttribute("slot","content"),t.textContent="404 Not Found",this.appendChild(t)}}}function Qn(t,n){n.startsWith(Zn)&&(n=n.substring(Zn.length)),Un.push([n,t])}function Xn(){return Jn}const Yn="router",te=`<slot name="${Yn}"></slot>`;class ne extends HTMLElement{constructor(){super(),e.enableShadowDom&&this.attachShadow({mode:"open"})}async connectedCallback(){await this.Be(),this.L()}get root(){return this.shadowRoot??this}async Be(){if(e.layoutPath){const t=await fetch(e.layoutPath);if(t.ok){const n=await t.text(),e=document.createElement("template");e.innerHTML=n;const s=e.content.querySelector("template"),i=e.content.querySelector("style");if(this.root.appendChild(s?.content??document.createDocumentFragment()),i){const t=this.shadowRoot??document,n=t.adoptedStyleSheets;n.includes(i)||(t.adoptedStyleSheets=[...n,i])}}else f(`Failed to load layout from ${e.layoutPath}`)}else this.root.innerHTML=te}L(){if(e.enableRouter){const t=document.createElement(e.routerTagName);t.setAttribute("slot",Yn),this.root.appendChild(t)}}}const ee=e;let se=!1;async function ie(t){await async function(t){for(const[n,s]of Object.entries(t)){let t=null;if(e.enableRouter){const t=s.startsWith("@routes")?s.slice(7):s;Qn(n,"/root"===t?"/":t)}t=await Hn(s),Wn(n,Vn(t))}}(t),ee.autoInit&&await re()}async function re(){se||(await async function(){if(e.autoLoadFromImportMap&&await _n(),e.enableRouter&&customElements.define(e.routerTagName,Kn),e.enableMainWrapper&&(customElements.define(e.mainTagName,ne),e.autoInsertMainWrapper)){const t=document.createElement(e.mainTagName);document.body.appendChild(t)}}(),se=!0)}export{re as bootstrapStructive,ee as config,ie as defineComponents};
//# sourceMappingURL=structive.min.js.map
