const t={debug:!1,locale:"en-US",t:!0};function e(){return t}function n(t){throw new Error(`${t} requires at least one option`)}function s(t){throw new Error(`${t} requires a number as option`)}function i(t){throw new Error(`${t} requires a number value`)}function r(t){throw new Error(`${t} requires a date value`)}const o=e(),l={i:t=>{const e=t?.[0]??n("eq"),r=Number(e);return isNaN(r)&&s("eq"),t=>("number"!=typeof t&&i("eq"),t===r)},o:t=>{const e=t?.[0]??n("ne"),r=Number(e);return isNaN(r)&&s("ne"),t=>("number"!=typeof t&&i("ne"),t!==r)},l:t=>t=>("boolean"!=typeof t&&function(t){throw new Error(`${t} requires a boolean value`)}("not"),!t),u:t=>{const e=t?.[0]??n("lt"),r=Number(e);return isNaN(r)&&s("lt"),t=>("number"!=typeof t&&i("lt"),t<r)},h:t=>{const e=t?.[0]??n("le"),r=Number(e);return isNaN(r)&&s("le"),t=>("number"!=typeof t&&i("le"),t<=r)},p:t=>{const e=t?.[0]??n("gt"),r=Number(e);return isNaN(r)&&s("gt"),t=>("number"!=typeof t&&i("gt"),t>r)},m:t=>{const e=t?.[0]??n("ge"),r=Number(e);return isNaN(r)&&s("ge"),t=>("number"!=typeof t&&i("ge"),t>=r)},N:t=>{const e=t?.[0]??n("inc"),r=Number(e);return isNaN(r)&&s("inc"),t=>("number"!=typeof t&&i("inc"),t+r)},S:t=>{const e=t?.[0]??n("dec"),r=Number(e);return isNaN(r)&&s("dec"),t=>("number"!=typeof t&&i("dec"),t-r)},mul:t=>{const e=t?.[0]??n("mul"),r=Number(e);return isNaN(r)&&s("mul"),t=>("number"!=typeof t&&i("mul"),t*r)},div:t=>{const e=t?.[0]??n("div"),r=Number(e);return isNaN(r)&&s("div"),t=>("number"!=typeof t&&i("div"),t/r)},v:t=>{const e=Number(t?.[0]??0);return isNaN(e)&&s("div"),t=>("number"!=typeof t&&i("div"),t.toFixed(e))},locale:t=>{const e=t?.[0]??o.locale;return t=>("number"!=typeof t&&i("locale"),t.toLocaleString(e))},I:t=>t=>t.toString().toUpperCase(),C:t=>t=>t.toString().toLowerCase(),cap:t=>t=>{const e=t.toString();return 0===e.length?e:1===e.length?e.toUpperCase():e.charAt(0).toUpperCase()+e.slice(1)},trim:t=>t=>t.toString().trim(),slice:t=>{const e=t?.[0]??n("slice"),i=Number(e);return isNaN(i)&&s("slice"),t=>t.toString().slice(i)},substr:t=>{const e=t?.[0]??n("substr"),i=Number(e);isNaN(i)&&s("substr");const r=t?.[1]??n("substr"),o=Number(r);return isNaN(o)&&s("substr"),t=>t.toString().substr(i,o)},pad:t=>{const e=t?.[0]??n("pad"),i=Number(e);isNaN(i)&&s("pad");const r=t?.[1]??"0";return t=>t.toString().padStart(i,r)},T:t=>{const e=t?.[0]??n("rep"),i=Number(e);return isNaN(i)&&s("rep"),t=>t.toString().repeat(i)},rev:t=>t=>t.toString().split("").reverse().join(""),L:t=>t=>parseInt(t,10),float:t=>t=>parseFloat(t),round:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&s("round"),t=>("number"!=typeof t&&i("round"),Math.round(t*n)/n)},floor:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&s("floor"),t=>("number"!=typeof t&&i("floor"),Math.floor(t*n)/n)},ceil:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&s("ceil"),t=>("number"!=typeof t&&i("ceil"),Math.ceil(t*n)/n)},percent:t=>{const e=Number(t?.[0]??0);return isNaN(e)&&s("percent"),t=>("number"!=typeof t&&i("percent"),t.toFixed(e)+"%")},B:t=>(t?.[0]??o.locale,t=>(t instanceof Date||r("date"),t.toLocaleDateString(o.locale))),time:t=>(t?.[0]??o.locale,t=>(t instanceof Date||r("time"),t.toLocaleTimeString(o.locale))),$:t=>(t?.[0]??o.locale,t=>(t instanceof Date||r("datetime"),t.toLocaleString(o.locale))),R:t=>{const e=t?.[0]??"-";return t=>{t instanceof Date||r("ymd");const n=t.getFullYear().toString(),s=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${n}${e}${s}${e}${i}`}},M:t=>t=>!1===t||null==t||0===t||""===t||Number.isNaN(t),P:t=>t=>!1!==t&&null!=t&&0!==t&&""!==t&&!Number.isNaN(t),k:t=>{const e=t?.[0]??n("defaults");return t=>!1===t||null==t||0===t||""===t||Number.isNaN(t)?e:t},F:t=>t=>Boolean(t),number:t=>t=>Number(t),string:t=>t=>String(t),null:t=>t=>""===t?null:t},u=l,c=l;let a=0;function h(){return++a}function d(t){throw new Error(t)}const f={};const p={};function m(t,e){const n=new CSSStyleSheet;n.replaceSync(e),function(t,e){p[t]=e}(t,n)}function g(t,e){const n=t[e.name];return n||d(`outputBuiltinFiltersFn: filter not found: ${name}`),n(e.options)}const b=new Map;function y(t,e){let n=b.get(e);if(void 0===n){n=[];for(let s=0;s<e.length;s++)n.push(g(t,e[s]));b.set(e,n)}return n}class w{#t;#e;#n;#s;#i;#r=new Set;get node(){return this.#e}get name(){return this.#n}get binding(){return this.#t}get event(){return this.#i}get filters(){return this.#s}get V(){return this.#r}constructor(t,e,n,s,i){this.#t=t,this.#e=e,this.#n=n,this.#s=s,this.#i=i}init(){}update(){this.O(this.binding.A.H)}O(t){d("BindingNode: assignValue not implemented")}j(t,e){d("BindingNode: updateElements not implemented")}get G(){return this.node instanceof HTMLSelectElement}}class x extends w{#o;get q(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}O(t){(null==t||Number.isNaN(t))&&(t="");this.node.setAttribute(this.q,t.toString())}}class N extends w{O(t){Array.isArray(t)||d("BindingNodeCheckbox.update: value is not array");const e=this.node;e.checked=t.map((t=>t.toString())).includes(e.value)}}class S extends w{O(t){Array.isArray(t)||d("BindingNodeClassList.update: value is not array");this.node.className=t.join(" ")}}class v extends w{#o;get q(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}O(t){"boolean"!=typeof t&&d("BindingNodeClassName.update: value is not boolean");const e=this.node;t?e.classList.add(this.q):e.classList.remove(this.q)}}class I extends w{#o;constructor(t,e,n,s,i){super(t,e,n,s,i),this.#o=this.name.slice(2);e.addEventListener(this.q,(t=>this.D(t)))}get q(){return this.#o}update(){}D(t){const e=this.binding.A,n=this.binding.W,s=n.U,i=n._,r=this.binding.K.J,o=r?.X().map((t=>t.Y.index))??[];"preventDefault"===this.event&&t.preventDefault(),this.binding.W._.Z((async()=>{const l=e.value,u=typeof l;i.Z((async()=>{r?await n.tt(r,(async()=>{"function"===u&&await Reflect.apply(l,s,[t,...o])})):"function"===u&&await Reflect.apply(l,s,[t,...o])}))}))}}const C=(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new I(s,i,t,o,n)},T="data-bind",E="@@:",L="@@|";class B extends w{#l;get id(){return this.#l}constructor(t,e,n,s,i){super(t,e,n,s,i);const r=this.node.textContent?.slice(3)??d("BindingNodeBlock.id: invalid node");this.#l=Number(r)}}class $ extends B{#u;#c;#a=new Set;#r;get V(){return this.#r}constructor(t,e,n,s,i){super(t,e,n,s,i),this.#u=Ot(this.binding,this.id,this.binding.W,"",null),this.#c=this.#r=new Set([this.#u])}O(t){"boolean"!=typeof t&&d("BindingNodeIf.update: value is not boolean");const e=this.node.parentNode;null==e&&d("BindingNodeIf.update: parentNode is null"),t?(this.#u.et(),this.#u.nt(e,this.node.nextSibling),this.#r=this.#c):(this.#u.unmount(),this.#r=this.#a)}}class R extends B{#h=new Set;#d=new WeakMap;#f=[];#p=0;get V(){return this.#h}init(){}st(t){let e;return this.#p>=0?(e=this.#f[this.#p],this.#p--,e.it(t)):e=Ot(this.binding,this.id,this.binding.W,this.binding.A.pattern+".*",t),this.#d.set(t,e),e}rt(t){t.unmount(),t.lt?.ot()}get ut(){return this.#p}set ut(t){this.#p=t}get ct(){return this.#f.length}set ct(t){t<0&&d("BindingNodeFor.setPoolLength: length is negative"),this.#f.length=t}O(t){Array.isArray(t)||d("BindingNodeFor.assignValue: value is not array");const e=this.binding.W.ht(this.binding.A.info,this.binding.A.Y);null===e&&d("BindingNodeFor.assignValue: listIndexes is not found"),this.ut=this.ct-1;const n=new Set;let s=null;const i=this.node.parentNode;null==i&&d("BindingNodeFor.update: parentNode is null");for(const t of e){const e=s?.dt(i)??this.node;let r=this.#d.get(t);void 0===r?(r=this.st(t),r.et(),r.ft(i,e)):e.nextSibling!==r.gt&&r.ft(i,e),n.add(r),s=r}this.ct=this.ut+1;const r=this.#h.difference(n);for(const t of r)this.rt(t);this.#f.push(...r),this.#h=n}j(t,e){if("object"!=typeof e[0])return;const n=this.binding.W,s=n.bt(this.binding.A.info,this.binding.A.Y)??d("BindingNodeFor.updateElements: oldValues is not found"),i=this.node.parentNode??d("BindingNodeFor.update: parentNode is null"),r=Array.from(this.#h),o=[];for(let e=0;e<t.length;e++){const n=r[t[e].index];n.unmount(),o.push(n)}for(let n=0;n<t.length;n++){const l=t[n],u=l.index,c=r[u-1]??null,a=c?.yt??this.node,h=s[u],d=e.indexOf(h),f=o[d];if(void 0===f){const t=o[u];t.et(),t.ft(i,a)}else f.it(l),f.ft(i,a),this.#d.set(l,f),r[u]=f;d>=0&&(e[d]=-1)}this.#h=new Set(r),n.wt(this.binding.A.info,this.binding.A.Y,this.binding.A.value.slice(0))}}const M=(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new R(s,i,t,o,n)},P="textContent",k={xt:"checked",Nt:"checked",button:"onclick"},F={},V={HTMLElement:t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLOptionElement?"value":t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement?"onclick":t instanceof HTMLFormElement?"onsubmit":t instanceof HTMLInputElement?k[t.type]??"value":P,SVGElement:void 0,Text:t=>P,St:void 0};const O="state",H=Symbol.for(`${O}.GetByRef`),A=Symbol.for(`${O}.SetByRef`),j=Symbol.for(`${O}.SetCacheable`),G=Symbol.for(`${O}.ConnectedCallback`),q=Symbol.for(`${O}.DisconnectedCallback`),D=Symbol.for(`${O}.Resolve`),W=Symbol.for(`${O}.GetAll`);const U={value:"input",checked:"change",selected:"change"};class _ extends w{get value(){return this.node[this.name]}get H(){let t=this.value;for(let e=0;e<this.filters.length;e++)t=this.filters[e](t);return t}constructor(t,e,n,s,i){super(t,e,n,s,i);if(!(this.node instanceof HTMLElement))return;if(!((r=this.node)instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement))return;var r;const o=function(t,e){const n=t.constructor.name+"\t"+(t.type??"");return F[n]??(F[n]=V[e]?.(t))}(this.node,"HTMLElement");if(o!==this.name)return;const l=this.event??U[this.name]??"readonly";"readonly"!==i&&"ro"!==i&&this.node.addEventListener(l,(()=>{const t=this.binding.K.J,e=this.binding.W,n=e.U,s=this.binding.A,i=this.H;e._.Z((()=>{t?e.tt(t,(async()=>{n[A](s.info,s.Y,i)})):n[A](s.info,s.Y,i)}))}))}init(){}O(t){(null==t||Number.isNaN(t))&&(t=""),this.node[this.name]=t}}const z=(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new _(s,i,t,o,n)};class Q extends w{O(t){(null==t||Number.isNaN(t))&&(t="");const e=this.node;e.checked=t.toString()===e.value.toString()}}class J extends w{#o;get q(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}O(t){(null==t||Number.isNaN(t))&&(t="");this.node.style.setProperty(this.q,t.toString())}}const K={0:{vt:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new S(s,i,t,o,n)},Nt:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new N(s,i,t,o,n)},xt:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new Q(s,i,t,o,n)}},1:{It:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new $(s,i,t,o,n)}}},X={vt:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new v(s,i,t,o,n)},Ct:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new x(s,i,t,o,n)},style:(t,e,n)=>(s,i,r)=>{const o=y(r,e);return new J(s,i,t,o,n)}};const Y={};function Z(t,e,n,s){const i=t instanceof Comment,r=t instanceof Element,o=i+"\t"+r+"\t"+e,l=Y[o]??(Y[o]=function(t,e,n){const s=K[t?1:0][n];if(void 0!==s)return s;if(t&&"for"===n)return M;t&&d(`getBindingNodeCreator: unknown node property ${n}`);const i=n.split("."),r=X[i[0]];return void 0!==r?r:e&&n.startsWith("on")?C:z}(i,r,e));return l(e,n,s)}const tt={};class et{static id=0;id=++et.id;pattern;Tt;Et;Lt;Bt;$t;Rt;Mt;Pt;kt;Ft;Vt;Ot;Ht;constructor(t){const e=e=>t===e?this:st(e),n=t.split("."),s=[],i=[],r=[],o=[],l=[],u=[];let c="",a="",h=0;for(let t=0;t<n.length;t++)c+=n[t],"*"===n[t]&&(r.push(c),o.push(e(c)),l.push(a),u.push(e(a)),h++),s.push(c),i.push(e(c)),a=c,c+=".";const d=r.length>0?r[r.length-1]:null,f=s.length>1?s[s.length-2]:null;this.pattern=t,this.Tt=n,this.Et=n[n.length-1],this.Lt=s,this.Bt=i,this.$t=r,this.Rt=o,this.Mt=l,this.Pt=u,this.kt=d,this.Ft=d?e(d):null,this.Vt=f,this.Ot=f?e(f):null,this.Ht=h}}const nt=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","watch","unwatch","eval","arguments","let","var","const","class","function","null","true","false","new","return"]);function st(t){let e;return e=tt[t],void 0!==e?e:(nt.has(t)&&d(`getStructuredPathInfo: pattern is reserved word: ${t}`),tt[t]=new et(t))}class it{#t;#m;#g;#b=null;#y;#s;get pattern(){return this.#m}get info(){return this.#g}get Y(){return null===this.#b?null:this.#b.deref()??d("listIndex is null")}get state(){return this.#y}get filters(){return this.#s}get binding(){return this.#t}constructor(t,e,n,s){this.#t=t,this.#m=n,this.#g=st(n),this.#y=e,this.#s=s}get value(){return this.#y[H](this.info,this.Y)}get H(){let t=this.value;for(let e=0;e<this.#s.length;e++)t=this.#s[e](t);return t}init(){if(this.info.Ht>0){const t=this.info.kt??d("BindingState.init: wildcardLastParentPath is null"),e=this.binding.K.lt?.find(t)??d("BindingState.init: loopContext is null");this.#b=e.At}this.binding.W.jt(this.info,this.Y,this.binding)}}class rt{#t;#w;#b=null;#y;#s;get pattern(){return d("Not implemented")}get info(){return d("Not implemented")}get Y(){return null===this.#b?null:this.#b.deref()??d("listIndex is null")}get state(){return this.#y}get filters(){return this.#s}get binding(){return this.#t}constructor(t,e,n,s){this.#t=t;const i=Number(n.slice(1));isNaN(i)&&d("BindingStateIndex: pattern is not a number"),this.#w=i,this.#y=e,this.#s=s}get value(){return this.Y?.index??d("listIndex is null")}get H(){let t=this.value;for(let e=0;e<this.#s.length;e++)t=this.#s[e](t);return t}init(){const t=(this.binding.K.J??d("BindingState.init: loopContext is null")).X();this.#b=t[this.#w-1].At??d("BindingState.init: listIndexRef is null");const e=this.Y??d("listIndex is null"),n=this.binding.W.Gt.get(e);void 0===n?this.binding.W.Gt.set(e,new Set([this.binding])):n.add(this.binding)}}const ot=new RegExp(/^\$\d+$/);function lt(t,e){return ot.test(t)?((t,e)=>(n,s,i)=>{const r=y(i,e);return new rt(n,s,t,r)})(t,e):((t,e)=>(n,s,i)=>{const r=y(i,e);return new it(n,s,t,r)})(t,e)}const ut={Text:t=>t.textContent?.slice(3).trim()??"",HTMLElement:t=>t.getAttribute(T)??"",St:t=>{const e=t.textContent?.slice(3).trim();return($t(Number(e))??d(`Template not found: ${e}`)).getAttribute(T)??""},SVGElement:t=>t.getAttribute(T)??""};const ct={};function at(t,e=(t=>t.constructor.name+"\t"+(t instanceof Comment?t.textContent?.[2]??"":""))(t)){return ct[e]??(ct[e]=(t=>t instanceof Comment&&":"===t.textContent?.[2]?"Text":t instanceof HTMLElement?"HTMLElement":t instanceof Comment&&"|"===t.textContent?.[2]?"Template":t instanceof SVGElement?"SVGElement":d(`Unknown NodeType: ${t.nodeType}`))(t))}const ht=t=>t.trim(),dt=t=>t.length>0,ft=new RegExp(/^#(.*)#$/),pt=t=>{const e=ft.exec(t);return e?decodeURIComponent(e[1]):t},mt=t=>{const[e,...n]=t.split(",").map(ht);return{name:e,options:n.map(pt)}},gt=t=>{const[e,...n]=t.split("|").map(ht);return{qt:e,filters:n.map(mt)}},bt=t=>t.split(";").map(ht).filter(dt).map((t=>(t=>{const[e,n=null]=t.split("@").map(ht),[s,i]=e.split(":").map(ht),{qt:r,filters:o}=gt(s),{qt:l,filters:u}=gt(i);return{Dt:r,Wt:l,Ut:o,_t:u,event:n}})(t))),yt={};const wt=t=>{t.removeAttribute("data-bind")},xt={HTMLElement:wt,SVGElement:wt,Text:void 0,St:void 0};const Nt={Text:t=>{const e=document.createTextNode("");return t.parentNode?.replaceChild(e,t),e},HTMLElement:void 0,St:void 0,SVGElement:void 0};class St{nodeType;zt;Qt;Jt=new Map;constructor(t){this.nodeType=at(t);const e=function(t,e){const n=ut[t](e)??"";return"Text"===t?"textContent:"+n:n}(this.nodeType,t);(function(t,e){xt[e]?.(t)})(t=function(t,e){return Nt[e]?.(t)??t}(t,this.nodeType),this.nodeType),this.zt=function(t){let e=[];for(;null!==t.parentNode;)e=[Array.from(t.parentNode.childNodes).indexOf(t),...e],t=t.parentNode;return e}(t),this.Qt=function(t){return""===t.trim()?[]:yt[t]??(yt[t]=bt(t))}(e);for(let e=0;e<this.Qt.length;e++){const n=this.Qt[e],s={Kt:Z(t,n.Dt,n.Ut,n.event),Xt:lt(n.Wt,n._t)};this.Jt.set(n,s)}}}function vt(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,{acceptNode:t=>t instanceof Element?t.hasAttribute(T)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:function(t){return t instanceof Comment&&(0===t.textContent?.indexOf(E)||0===t.textContent?.indexOf(L))}(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;n.nextNode();)e.push(n.currentNode);return e}const It={},Ct={},Tt={};function Et(t){return vt(t).map((t=>function(t){return new St(t)}(t)))}const Lt={};function Bt(t,e,n){var s;return s=e.content,Array.from(s.childNodes).forEach((t=>{t.nodeType!==Node.TEXT_NODE||(t.nodeValue??"").trim()||s.removeChild(t)})),function(t,e,n=t){const s=Et(e),i=Tt[n]??(Tt[n]=new Set),r=Ct[n]??(Ct[n]=new Set);for(let t=0;t<s.length;t++){const e=s[t];for(let t=0;t<e.Qt.length;t++){const n=e.Qt[t];i.add(n.Wt),"for"===n.Dt&&r.add(n.Wt)}}It[t]=s}(t,e.content,n),Lt[t]=e,t}function $t(t){return Lt[t]??d(`getTemplateById: template not found: ${t}`)}class Rt{K;node;W;Yt;A;constructor(t,e,n,s,i){this.K=t,this.node=e,this.W=n,this.Yt=s(this,e,n.Zt),this.A=i(this,n.U,n.te)}get V(){return this.Yt.V}init(){this.Yt.init(),this.A.init()}et(){this.Yt.update()}}function Mt(t,e,n,s,i){return new Rt(t,e,n,s,i)}class Pt{#x;#g;#b;#u;constructor(t,e,n){this.#x=t??d("name is required"),this.#g=st(this.#x),this.#b=new WeakRef(e),this.#u=n}get path(){return this.#x}get info(){return this.#g}get Y(){return this.#b?.deref()??d("listIndex is null")}get At(){return this.#b??d("listIndexRef is null")}it(t){this.#b=new WeakRef(t)}ot(){this.#b=null}get ee(){return this.#u}#N;get ne(){if(void 0===this.#N){let t=this.ee;for(;null!==t;){if(null!==t.lt&&t.lt!==this){this.#N=t.lt;break}t=t.se?.K??null}void 0===this.#N&&(this.#N=null)}return this.#N}#S={};find(t){let e=this.#S[t];if(void 0===e){let n=this;for(;null!==n&&n.path!==t;)n=n.ne;e=this.#S[t]=n}return e}ie(t){let e=this;for(;null!==e;)t(e),e=e.ne}X(){const t=[];return this.ie((e=>{t.unshift(e)})),t}}function kt(t){const e=[];for(let n=0;n<t.length;n++){const s=t[n];s.Yt.G?e.push(s):s.et()}for(let t=0;t<e.length;t++)e[t].et()}function Ft(t,e,n,s){const i=(t=>It[t])(e)??d("BindContent: data-bind is not set"),r=[];for(let e=0;e<i.length;e++){const l=i[e],u=(o=s,l.zt.reduce(((t,e)=>t?.childNodes[e]??null),o)??d(`BindContent: node is not found: ${l.zt}`));for(let e=0;e<l.Qt.length;e++){const s=l.Qt[e],i=l.Jt.get(s)??d(`BindContent: creator is not found: ${s}`),o=Mt(t,u,n,i.Kt,i.Xt);r.push(o)}}var o;return r}class Vt{lt;se;childNodes;fragment;W;#l;get id(){return this.#l}get re(){return this.childNodes.length>0&&this.childNodes[0].parentNode!==this.fragment}get gt(){return this.childNodes[0]??null}get yt(){return this.childNodes[this.childNodes.length-1]??null}dt(t){const e=this.oe[this.oe.length-1],n=this.yt;if(e.node===n&&e.V.size>0){const n=(Array.from(e.V).at(-1)??d("BindContent: childBindContent is not found")).dt(t);if(null!==n)return n}return t!==n?.parentNode?null:n}#v;get J(){if(void 0===this.#v){let t=this;for(;null!==t&&null===t.lt;)t=t.se?.K??null;this.#v=t?.lt??null}return this.#v}constructor(t,e,n,s,i){this.se=t,this.#l=e,this.fragment=function(t){const e=$t(t)??d(`BindContent: template is not found: ${t}`);return document.importNode(e.content,!0)}(e),this.childNodes=Array.from(this.fragment.childNodes),this.W=n,this.lt=null!==i?function(t,e,n){return new Pt(t,e,n)}(s,i,this):null,this.oe=Ft(this,e,n,this.fragment)}mount(t){t.appendChild(this.fragment)}nt(t,e){t.insertBefore(this.fragment,e)}ft(t,e){t.insertBefore(this.fragment,e?.nextSibling??null)}unmount(){for(let t=0;t<this.childNodes.length;t++)this.fragment.appendChild(this.childNodes[t])}oe=[];et(){kt(this.oe)}init(){this.oe.forEach((t=>t.init()))}it(t){null==this.lt&&d("BindContent: loopContext is null"),this.lt.it(t),this.init()}}function Ot(t,e,n,s,i){const r=new Vt(t,e,n,s,i);return r.init(),r}const Ht={};class At{static id=0;id=++At.id;name;elements;le;Ht;ue;ce;info;constructor(t){const e=t.split("."),n=e.slice(),s=[];let i=0,r=0,o="",l=0,u="none",c=[];for(let t=0;t<e.length;t++){const u=e[t];if("*"===u)n[t]="*",c.push(null),i++,l++;else{const e=Number(u);Number.isNaN(e)||(n[t]="*",c.push(e),r++,l++)}o+=u,s.push(o),o+=t<e.length-1?".":""}const a=st(n.join("."));(i>0||r>0)&&(u=i===l?"context":r===l?"all":"partial"),this.name=t,this.elements=e,this.le=s,this.Ht=l,this.ue=u,this.ce=c,this.info=a}}function jt(t){return Ht[t]??(Ht[t]=new At(t))}class Gt{static id=0;id=++Gt.id;#I=null;get ae(){return this.#I}index;get he(){const t=this.ae?.he??[];return t.push(this.index),t}get position(){return(this.ae?.position??-1)+1}constructor(t,e){this.#I=t,this.index=e}truncate(t){let e=this;for(;null!==e;){if(e.position<t)return e;e=e.ae}return null}add(t){return new Gt(this,t)}*de(){yield this,null!==this.ae&&(yield*this.ae.de())}*iterator(){null!==this.ae&&(yield*this.ae.iterator()),yield this}toString(){const t=this.ae?.toString();return null!==t?t+","+this.index.toString():this.index.toString()}at(t){let e,n;for(t>=0?e=this.iterator():(t=-t-1,e=this.de());t>=0;)n=e.next(),t--;return n?.value??null}}function qt(t,e){const n=Gt.id;return t.id*(n+1)+(e?.id??0)}const Dt=new RegExp(/^\$(\d+)$/);function Wt(t,e){if(0===t.info.Ht)return null;let n=null;const s=t.info.kt??d("lastWildcardPath is null");if("context"===t.ue)n=e.fe(s)??d(`ListIndex not found: ${t.info.pattern}`);else if("all"===t.ue){let s=null;for(let n=0;n<t.info.Ht;n++){const i=t.info.Pt[n]??d("wildcardParentPattern is null");s=Array.from(e.ht(i,s)??[])[t.ce[n]??d("wildcardIndex is null")]??d(`ListIndex not found: ${i.pattern}`)}n=s}else"partial"===t.ue||t.ue;return n}class Ut{W;pe=!1;cache={};constructor(t){this.W=t}me(t,e,n,s){if(null!=this.#C&&this.#C!==e){const t=this.#C;t.Ot!==e&&this.W.ge(t,e)}let i,r=0;if(this.pe){r=qt(e,n);const t=this.cache[r];if(void 0!==t)return t;if(r in this.cache)return}try{if(e.pattern in t)return e.Ht>0?(null===n&&d("propRef.listIndex is null"),i=this.W.be(e,n,(()=>Reflect.get(t,e.pattern,s)))):i=Reflect.get(t,e.pattern,s);{const r=e.Ot??d("propRef.stateProp.parentInfo is undefined"),o=r.Ht<e.Ht?n?.ae??null:n,l=this.ye(t,r,o,s),u=e.Et;if("*"===u){const t=n?.index??d("propRef.listIndex?.index is undefined");return i=Reflect.get(l,t)}return i=Reflect.get(l,u)}}finally{this.pe&&!(r in this.cache)&&(this.cache[r]=i)}}#T=[];#C=null;we(t,e){this.#T.push(t),this.#C=t;try{return e()}finally{this.#T.pop(),this.#C=this.#T[this.#T.length-1]??null}}ye(t,e,n,s){return this.W.xe.has(e.pattern)?this.we(e,(()=>this.me(t,e,n,s))):this.me(t,e,n,s)}Ne(t,e,n,s,i){try{if(e.pattern in t)return e.Ht>0?(null===n&&d("propRef.listIndex is null"),this.W.be(e,n,(()=>Reflect.set(t,e.pattern,s,i)))):Reflect.set(t,e.pattern,s,i);{const r=e.Ot??d("propRef.stateProp.parentInfo is undefined"),o=r.Ht<e.Ht?n?.ae??null:n,l=this.ye(t,r,o,i),u=e.Et;if("*"===u){const t=n?.index??d("propRef.listIndex?.index is undefined");return Reflect.set(l,t,s)}return Reflect.set(l,u,s)}}finally{this.W._.Se(e,n,s)}}async ve(t){this.pe=!0,this.cache={};try{await t()}finally{this.pe=!1}}[H](t,e,n){const s=this;return(e,i)=>s.ye(t,e,i,n)}[A](t,e,n){const s=this;return(e,i,r)=>s.Ne(t,e,i,r,n)}[j](t,e,n){const s=this;return async t=>{await s.ve(t)}}[G](t,e,n){return async()=>{const e=Reflect.get(t,"$connectedCallback");"function"==typeof e&&await e.call(t,n)}}[q](t,e,n){return async()=>{const e=Reflect.get(t,"$disconnectedCallback");"function"==typeof e&&await e.call(t,n)}}[D](t,e,n){const s=this;return(e,i,r)=>{const o=st(e);let l=null;for(let t=0;t<o.Pt.length;t++){const e=o.Pt[t]??d("wildcardParentPath is null");l=Array.from(s.W.ht(e,l)??[])[i[t]??d("index is null")]??d(`ListIndex not found: ${e.pattern}`)}return void 0===r?s.ye(t,o,l,n):s.Ne(t,o,l,r,n)}}[W](t,e,n){const s=this,i=this[D](t,e,n);return(t,e)=>{const n=st(t);if(null!=this.#C&&this.#C!==n){const t=this.#C;t.Ot!==n&&this.W.ge(t,n)}if(void 0===e){for(let t=0;t<n.Rt.length;t++){const s=n.Rt[t]??d("wildcardPattern is null"),i=this.W.fe(s.pattern);if(i){e=i.he;break}}void 0===e&&(e=[])}const r=(t,e,n,i,o,l,u)=>{const c=t[e]??null;if(null===c)return void u.push(l);const a=s.W.ht(c,n)??d(`ListIndex not found: ${c.pattern}`),h=Array.from(a),f=i[o]??null;if(null===f)for(let n=0;n<h.length;n++){const s=h[n];r(t,e+1,s,i,o+1,l.concat(s.index),u)}else{const n=h[f]??d(`ListIndex not found: ${c.pattern}`);e+1<t.length&&r(t,e+1,n,i,o+1,l.concat(n.index),u)}},o=[];r(n.Pt,0,null,e,0,[],o);const l=[];for(let t=0;t<o.length;t++)l.push(i(n.pattern,o[t]));return l}}Ie=new Set([H,A,j,G,q,D,W]);get(t,e,n){let s;if("string"==typeof e){if(Dt.test(e)){const t=e.slice(1),n=Number(t),s=this.W.Ce()??d("get: this.engine.getLastStatePropertyRef() is null");return s.Y?.at(n-1)?.index??d(`ListIndex not found: ${e}`)}if("$resolve"===e)return this[D].apply(this,[t,e,n]);if("$getAll"===e)return this[W].apply(this,[t,e,n]);{const i=jt(e),r=Wt(i,this.W);s=this.ye(t,i.info,r,n)}}else if("symbol"==typeof e){if(this.Ie.has(e)){return Reflect.get(this,e).apply(this,[t,e,n])}s=Reflect.get(t,e,n)}return s}set(t,e,n,s){if("string"==typeof e){const i=jt(e),r=Wt(i,this.W);return this.Ne(t,i.info,r,n,s)}return Reflect.set(t,e,n,s)}}const _t=new Set;function zt(t,e,n,s,i){const r=t.bt(n,s)??[];if(r===i)return;const o=t.ht(n,s)??_t,l=Map.groupBy(o,(t=>r[t.index])),u=new Set;for(let e=0;e<i.length;e++){const n=i[e],r=l.get(n);let o=r?.shift();o?o.index!==e&&(o.index=e,t._.Te(o)):o=new Gt(s,e),u.add(o)}t.Ee(n,s,u),t.wt(n,s,i.slice(0));const c=n.pattern+".*";for(const n of e)if(c===n.kt)for(const s of u){const i=t.U[H](n,s);zt(t,e,n,s,i??[])}}function Qt(t,e,n,s){if(t.Le,!t.Le.has(e))return;const i=s??[];zt(t,t.Le,e,n,i)}function Jt(t,e,n){const s=t.Pt??[],i=(t,r,o)=>{const l=s[t];if(!l)return void(r&&o.push(r));const u=e?.at(t)??null;if(u)i(t+1,u,o);else{const e=n.ht(l,r);for(const n of e??[])i(t+1,n,o)}},r=[];return i(0,e,r),r}function Kt(t,e,n,s,i){if(s.has(t))return;const r=n.Be.get(t);for(const o of r??[]){if(n.Le.has(t)&&o.Ot===t&&"*"===o.Et)continue;let r=null,l=!1;for(let n=o.Pt.length-1;n>=0;n--){const i=o.Pt[n];if(s.has(i)){l=!0;break}const u=t.Pt.indexOf(i);if(!(u<0)&&(r=e?.at(u)??null,null!==r))break}if(!l)if(o.Pt.length>0){const t=Jt(o,r,n);for(const e of t)i.push({info:o,Y:e}),Kt(o,e,n,s,i)}else i.push({info:o,Y:null}),Kt(o,null,n,s,i)}}function Xt(t,e){const n=new Set,s=[];for(const i of t){const t=i.info,r=i.Y;n.has(t)||(Kt(t,r,e,n,s),n.add(t))}return s}class Yt{$e=[];Re=new Set;Me={};W;constructor(t){this.W=t}Z(t){this.$e.push(t),this.Pe.resolve()}Se(t,e,n){const s=qt(t,e);this.Re.add({info:t,Y:e}),this.Me[s]=n,this.Pe.resolve()}Te(t){this.Re.add(t),this.Pe.resolve()}terminate(){const t=Promise.withResolvers();return this.Pe.resolve(t),t}Pe=Promise.withResolvers();async ke(t){await t.promise;const n=e();for(;;)try{const t=await this.Pe.promise;n.debug&&performance.mark("start"),Yt.Fe++;try{await this.exec(),n.debug&&(performance.mark("end"),performance.measure("exec","start","end"),console.log(performance.getEntriesByType("measure")),performance.clearMeasures("exec"),performance.clearMarks("start"),performance.clearMarks("end"))}finally{if(Yt.Fe--,t){t.resolve();break}}}catch(t){console.error(t)}finally{this.Pe=Promise.withResolvers()}}async Ve(){for(;this.$e.length>0;){const t=this.$e;this.$e=[];for(let e=0;e<t.length;e++){const n=t[e];await n()}}}async Oe(){const t=[],e=[],n=this.W,s=new Set,i=new Set;for(;this.Re.size>0;){const r=Array.from(this.Re.values()),o=[],l=[],u=[];this.Re.clear();for(let t=0;t<r.length;t++){const c=r[t];let a;if("index"in c){if(s.has(c))continue;const t=c;a=n.Gt.get(t),s.add(t)}else{const t=qt(c.info,c.Y);if(i.has(t))continue;const e=c;n.Le.has(e.info)&&l.push(e),n.He.has(e.info)&&u.push(e),a=n.Ae(c.info,c.Y),i.add(t),o.push(e)}e.push(...a??[])}const c=new Set;for(let t=0;t<l.length;t++){const e=l[t],s=qt(e.info,e.Y),i=this.Me[s]??null;Qt(n,e.info,e.Y,i),c.add(s)}const a={},h=Object.groupBy(u,(t=>{null===t.info.Ot&&d("parentInfo is null");const e=t.info.Ot,n=t.info.Ht===t.info.Ot.Ht?t.Y:t.Y?.ae??null,s=qt(e,n);return s in a||(a[s]={info:e,Y:n}),s}));for(const[e,s]of Object.entries(h)){const i=Number(e);if(c.has(i))continue;if(void 0===s)continue;const r=a[i];if(null===r)continue;const o=[],l=[];for(let t=0;t<s.length;t++){const e=s[t],n=qt(e.info,e.Y),i=this.Me[n]??null;o.push(i);const r=e.Y;if(null===r)throw new Error("listIndex is null");l.push(r)}const u=n.Ae(r.info,r.Y);for(const e of u){const n={je:r,binding:e,Ge:l,values:o};t.push(n)}}const f=Xt(o,n);for(const t of f){const s=n.Ae(t.info,t.Y);e.push(...s??[])}}return this.Me={},{oe:e,qe:t}}async et(t){await this.W.U[j]((async()=>kt(t)))}async exec(){for(;0!==this.$e.length||0!==this.Re.size;){await this.Ve();const{oe:t,qe:e}=await this.Oe();for(const t of e)t.binding.Yt.j(t.Ge,t.values);t.length>0&&await this.et(t)}}static Fe=0}function Zt(t,e,n){if(e.t)if(null===e.De||function(t){try{return"function"==typeof document.createElement(t).attachShadow}catch{return!1}}(e.De)){t.attachShadow({mode:"open"}).adoptedStyleSheets=[n]}else d(`ComponentEngine: Shadow DOM not supported for builtin components that extend ${e.De}`);else{const e=function(t){let e=t;for(;e;){if(e instanceof ShadowRoot)return e;e=e.parentNode}}(t.parentNode)||document,s=e.adoptedStyleSheets;s.includes(n)||(e.adoptedStyleSheets=[...s,n])}}class te{type="autonomous";config;We;styleSheet;Ue;state;U;_;Zt;te;ee;_e=HTMLElement;ze;xe;Le=new Set;He=new Set;Gt=new WeakMap;Be=new Map;#E=Promise.withResolvers();#L=null;#B=[];#$=[];constructor(t,e){this.config=t,this.config.De&&(this.type="builtin");const n=e.constructor;var s,i;this.We=n.We,this.styleSheet=n.styleSheet,this.Ue=n.Ue,this.state=new this.Ue,this.U=(s=this,i=this.state,new Proxy(i,new Ut(s))),this._=function(t){return new Yt(t)}(this),this.Zt=n.Zt,this.te=n.te,this.ze=e,this.xe=n.xe;const r=t=>{const e=t.Ot;null!==e&&(this.ge(t,e),r(e))};for(const t of n.le){const e=st(t);r(e)}for(const t of n.Qe)this.Le.add(st(t)),this.He.add(st(t+".*"));this.ee=Ot(null,n.id,this,null,null);for(const t of this.Le){if(t.Ht>0)continue;Qt(this,t,null,this.U[H](t,null))}this._.ke(this.#E)}async connectedCallback(){Zt(this.ze,this.config,this.styleSheet),await this.U[G](),await this.U[j]((async()=>{this.ee.et()})),this.ee.mount(this.ze.shadowRoot??this.ze),this.#E.resolve()}async disconnectedCallback(){await this.U[q]()}async tt(t,e){try{if(null!==this.#L)throw new Error("loopContext is already set");this.#L=t,await this.Je(t.info,t.Y,(async()=>{await e()}))}finally{this.#L=null}}async Je(t,e,n){this.#B.push(t),this.#$.push(e);try{return await n()}finally{this.#B.pop(),this.#$.pop()}}be(t,e,n){this.#B.push(t),this.#$.push(e);try{return n()}finally{this.#B.pop(),this.#$.pop()}}Ce(){if(0===this.#B.length)return null;const t=this.#B[this.#B.length-1];if(void 0===t)return null;const e=this.#$[this.#$.length-1];return void 0===e?null:{info:t,Y:e}}fe(t){const e=this.Ce();if(null===e)return null;const n=e.info.$t.indexOf(t);return n>=0?e.Y.at(n)??null:null}Ke(){if(null===this.#L)throw new Error("loopContext is null");return this.#L.X()}#R={};#M={};Xe(){return{list:null,Ye:null,oe:[]}}Ze(t,e){if(null===e){let e=this.#M[t.id];return void 0===e&&(e=this.Xe(),this.#M[t.id]=e),e}{let n=this.#R[t.id];void 0===n&&(n=new WeakMap,this.#R[t.id]=n);let s=n.get(e);return void 0===s&&(s=this.Xe(),n.set(e,s)),s}}jt(t,e,n){this.Ze(t,e).oe.push(n)}Ee(t,e,n){this.Ze(t,e).Ye=n}wt(t,e,n){this.Ze(t,e).list=n}Ae(t,e){return this.Ze(t,e).oe}ht(t,e){return this.Ze(t,e).Ye}bt(t,e){return this.Ze(t,e).list}ge(t,e){let n=this.Be.get(e);void 0===n&&(n=new Set,this.Be.set(e,n)),n.add(t)}}const ee=/\{\{([^\}]+)\}\}/g,ne=new Set(["if","for","endif","endfor","elseif","else"]);function se(t,e,n=t){if(e.parentNode?.replaceChild(document.createComment(`${L}${t}`),e),"http://www.w3.org/2000/svg"===e.namespaceURI){const t=document.createElement("template");for(let n of Array.from(e.childNodes))t.content.appendChild(n);const n=e.getAttribute(T);t.setAttribute(T,n??""),e=t}return e.content.querySelectorAll("template").forEach((t=>{se(h(),t,n)})),Bt(t,e,n),t}function ie(t,e){const n=document.createElement("template");n.dataset.id=t.toString(),n.innerHTML=function(t){const e=[];return t.replaceAll(ee,((t,n)=>{n=n.trim();const[s]=n.split(":");if(!ne.has(s))return`\x3c!--${E}${n}--\x3e`;const i=n.slice(s.length+1).trim(),r={type:s,tn:n,en:i};if("if"===s||"for"===s)return e.push(r),`<template data-bind="${n}">`;if("endif"===s){const t=[];for(;;){const n=e.pop()??d("replaceMustacheToTemplateOrEmbed: endif without if");if("if"===n.type){t.push("</template>");break}"elseif"===n.type?t.push("</template>"):d("replaceMustacheToTemplateOrEmbed: endif without if")}return t.join("")}if("endfor"===s){if("for"===(e.pop()??d("replaceMustacheToTemplateOrEmbed: endif without if")).type)return"</template>";d("replaceMustacheToTemplateOrEmbed: endfor without for")}else if("elseif"===s){const t=e.at(-1)??d("replaceMustacheToTemplateOrEmbed: elseif without if");if("if"===t.type||"elseif"===t.type)return e.push(r),`</template><template data-bind="if:${t.en}|not"><template data-bind="if:${i}">`;d("replaceMustacheToTemplateOrEmbed: elseif without if")}else if("else"===s){const t=e.at(-1)??d("replaceMustacheToTemplateOrEmbed: else without if");if("if"===t.type)return`</template><template data-bind="if:${t.en}|not">`;d("replaceMustacheToTemplateOrEmbed: else without if")}else d("replaceMustacheToTemplateOrEmbed: unknown type")}))}(e),se(t,n)}function re(t){const n=function(t){const n=e();return{t:t.t??n.t,De:t.De??null}}(t.config),s=h(),{nn:i,sn:r,Ue:o}=t,l=Object.assign({},c),a=Object.assign({},u);ie(s,i),m(s,r),function(t,e){f[t]=e}(s,o);const g=function(t){return t?document.createElement(t).constructor:HTMLElement}(n.De),b=n.De;return class extends g{#P;constructor(){super(),this.#P=function(t,e){return new te(t,e)}(n,this)}connectedCallback(){this.#P.connectedCallback()}disconnectedCallback(){this.#P.disconnectedCallback()}static define(t){b?customElements.define(t,this,{De:b}):customElements.define(t,this)}static get id(){return s}static#k=i;static get nn(){return this.#k}static set nn(t){this.#k=t,ie(this.id,t),this.#F=null}static#V=r;static get sn(){return this.#V}static set sn(t){this.#V=t,m(this.id,t),this.#O=null}static#F=null;static get We(){return this.#F||(this.#F=$t(this.id)),this.#F}static#O=null;static get styleSheet(){return this.#O||(this.#O=function(t){return p[t]??d(`getStyleSheetById: stylesheet not found: ${t}`)}(this.id)),this.#O}static#H=null;static get Ue(){return this.#H||(this.#H=function(t){return f[t]??d(`getStateClassById: stateClass not found: ${t}`)}(this.id)),this.#H}static#A=l;static get Zt(){return this.#A}static#j=a;static get te(){return this.#j}static get Qe(){return(t=>Ct[t]??[])(this.id)}static get le(){return(t=>Tt[t]??[])(this.id)}static#G=null;static get xe(){if(null===this.#G){this.#G=new Set;let t=this.Ue.prototype;for(;t&&t!==Object.prototype;){const e=Object.getOwnPropertyDescriptors(t);if(e)for(const[t,n]of Object.entries(e))n.get&&this.#G.add(t);t=Object.getPrototypeOf(t)}}return this.#G}}}function oe(t){return t.replaceAll(/<!--\{\{([^\}]+)\}\}-->/g,((t,e)=>`{{${e}}}`))}async function le(t){const e=await fetch(import.meta.resolve(t));return async function(t){const e=document.createElement("template");e.innerHTML=function(t){return t.replaceAll(/\{\{([^\}]+)\}\}/g,((t,e)=>`\x3c!--{{${e}}}--\x3e`))}(t);const n=e.content.querySelector("template");n?.remove();const s=e.content.querySelector("script"),i=s?await import("data:text/javascript;charset=utf-8,"+s.text):{};s?.remove();const r=e.content.querySelector("style");r?.remove();const o=i.default??class{};return{text:t,nn:oe(n?.innerHTML??"").trim(),sn:r?.textContent??"",Ue:o,config:o.rn??{}}}(await e.text())}function ue(t){!async function(t){const e=Promise.all(Object.entries(t).map((async([t,e])=>{!function(t,e){e.define(t)}(t,re(await le(e)))})));await e}(t)}const ce=ue;function ae(){return e()}export{ce as defineComponents,ae as getGlobalConfig,ue as registerSingleFileComponents};
//# sourceMappingURL=structive.min.js.map
