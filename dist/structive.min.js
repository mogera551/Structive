const t="routes:",e=[];let n=null;class s extends HTMLElement{t;constructor(){super(),this.t=this.i.bind(this)}connectedCallback(){n=this,this.innerHTML='<slot name="content"></slot>',window.addEventListener("popstate",this.t),window.dispatchEvent(new Event("popstate"))}disconnectedCallback(){window.removeEventListener("popstate",this.t),n=null}i(t){t.preventDefault(),this.o()}navigate(t){history.pushState({},"",t),this.o()}o(){Array.from(this.childNodes).filter((t=>"content"===t.getAttribute?.("slot"))).forEach((t=>this.removeChild(t)));const t=window.location.pathname||"/";let n,s={};for(const[i,r]of e){const e=new RegExp(i.replace(/:[^\s/]+/g,"([^/]+)"));if(e.test(t)){n=r;const o=t.match(e);if(o){(i.match(/:[^\s/]+/g)||[]).forEach(((t,e)=>{s[t.substring(1)]=o[e+1]}))}break}}if(n){const t=document.createElement(n);t.setAttribute("data-state",JSON.stringify(s)),t.setAttribute("slot","content"),this.appendChild(t)}else{const t=document.createElement("h1");t.setAttribute("slot","content"),t.textContent="404 Not Found",this.appendChild(t)}}}function i(n,s){s.startsWith(t)&&(s=s.substring(7)),e.push([s,n])}function r(){return n}const o={debug:!1,locale:"en-US",enableShadowDom:!0,enableMainWrapper:!0,enableRouter:!0,autoInsertMainWrapper:!1,autoInit:!0,mainTagName:"app-main",routerTagName:"view-router",layoutPath:"",autoLoadFromImportMap:!1,optimizeList:!0,optimizeListElements:!0,optimizeAccessor:!0};function l(){return o}const u=l();function c(t){throw new Error(`${t} requires at least one option`)}function a(t){throw new Error(`${t} requires a number as option`)}function h(t){throw new Error(`${t} requires a number value`)}function d(t){throw new Error(`${t} requires a date value`)}const f=l(),p={eq:t=>{const e=t?.[0]??c("eq");return t=>{if("number"==typeof t){const n=Number(e);return isNaN(n)&&a("eq"),t===n}return t===e}},ne:t=>{const e=t?.[0]??c("ne");return t=>{if("number"==typeof t){const n=Number(e);return isNaN(n)&&a("eq"),t!==n}return t!==e}},not:t=>t=>("boolean"!=typeof t&&function(t){throw new Error(`${t} requires a boolean value`)}("not"),!t),lt:t=>{const e=t?.[0]??c("lt"),n=Number(e);return isNaN(n)&&a("lt"),t=>("number"!=typeof t&&h("lt"),t<n)},le:t=>{const e=t?.[0]??c("le"),n=Number(e);return isNaN(n)&&a("le"),t=>("number"!=typeof t&&h("le"),t<=n)},gt:t=>{const e=t?.[0]??c("gt"),n=Number(e);return isNaN(n)&&a("gt"),t=>("number"!=typeof t&&h("gt"),t>n)},ge:t=>{const e=t?.[0]??c("ge"),n=Number(e);return isNaN(n)&&a("ge"),t=>("number"!=typeof t&&h("ge"),t>=n)},inc:t=>{const e=t?.[0]??c("inc"),n=Number(e);return isNaN(n)&&a("inc"),t=>("number"!=typeof t&&h("inc"),t+n)},dec:t=>{const e=t?.[0]??c("dec"),n=Number(e);return isNaN(n)&&a("dec"),t=>("number"!=typeof t&&h("dec"),t-n)},mul:t=>{const e=t?.[0]??c("mul"),n=Number(e);return isNaN(n)&&a("mul"),t=>("number"!=typeof t&&h("mul"),t*n)},div:t=>{const e=t?.[0]??c("div"),n=Number(e);return isNaN(n)&&a("div"),t=>("number"!=typeof t&&h("div"),t/n)},fix:t=>{const e=Number(t?.[0]??0);return isNaN(e)&&a("div"),t=>("number"!=typeof t&&h("div"),t.toFixed(e))},locale:t=>{const e=t?.[0]??f.locale;return t=>("number"!=typeof t&&h("locale"),t.toLocaleString(e))},uc:t=>t=>t.toString().toUpperCase(),lc:t=>t=>t.toString().toLowerCase(),cap:t=>t=>{const e=t.toString();return 0===e.length?e:1===e.length?e.toUpperCase():e.charAt(0).toUpperCase()+e.slice(1)},trim:t=>t=>t.toString().trim(),slice:t=>{const e=t?.[0]??c("slice"),n=Number(e);return isNaN(n)&&a("slice"),t=>t.toString().slice(n)},substr:t=>{const e=t?.[0]??c("substr"),n=Number(e);isNaN(n)&&a("substr");const s=t?.[1]??c("substr"),i=Number(s);return isNaN(i)&&a("substr"),t=>t.toString().substr(n,i)},pad:t=>{const e=t?.[0]??c("pad"),n=Number(e);isNaN(n)&&a("pad");const s=t?.[1]??"0";return t=>t.toString().padStart(n,s)},rep:t=>{const e=t?.[0]??c("rep"),n=Number(e);return isNaN(n)&&a("rep"),t=>t.toString().repeat(n)},rev:t=>t=>t.toString().split("").reverse().join(""),int:t=>t=>parseInt(t,10),float:t=>t=>parseFloat(t),round:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&a("round"),t=>("number"!=typeof t&&h("round"),Math.round(t*n)/n)},floor:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&a("floor"),t=>("number"!=typeof t&&h("floor"),Math.floor(t*n)/n)},ceil:t=>{const e=t?.[0]??0,n=Math.pow(10,Number(e));return isNaN(n)&&a("ceil"),t=>("number"!=typeof t&&h("ceil"),Math.ceil(t*n)/n)},percent:t=>{const e=Number(t?.[0]??0);return isNaN(e)&&a("percent"),t=>("number"!=typeof t&&h("percent"),t.toFixed(e)+"%")},date:t=>(t?.[0]??f.locale,t=>(t instanceof Date||d("date"),t.toLocaleDateString(f.locale))),time:t=>(t?.[0]??f.locale,t=>(t instanceof Date||d("time"),t.toLocaleTimeString(f.locale))),datetime:t=>(t?.[0]??f.locale,t=>(t instanceof Date||d("datetime"),t.toLocaleString(f.locale))),ymd:t=>{const e=t?.[0]??"-";return t=>{t instanceof Date||d("ymd");const n=t.getFullYear().toString(),s=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0");return`${n}${e}${s}${e}${i}`}},falsy:t=>t=>!1===t||null==t||0===t||""===t||Number.isNaN(t),truthy:t=>t=>!1!==t&&null!=t&&0!==t&&""!==t&&!Number.isNaN(t),defaults:t=>{const e=t?.[0]??c("defaults");return t=>!1===t||null==t||0===t||""===t||Number.isNaN(t)?e:t},boolean:t=>t=>Boolean(t),number:t=>t=>Number(t),string:t=>t=>String(t),null:t=>t=>""===t?null:t},m=p,g=p;let y=0;function w(){return++y}function b(t){throw new Error(t)}const x={};const N={};function S(t,e){const n=new CSSStyleSheet;n.replaceSync(e),function(t,e){N[t]=e}(t,n)}function v(t,e){const n=t[e.name];return n||b(`outputBuiltinFiltersFn: filter not found: ${name}`),n(e.options)}const I=new Map;function $(t,e){let n=I.get(e);if(void 0===n){n=[];for(let s=0;s<e.length;s++)n.push(v(t,e[s]));I.set(e,n)}return n}class C{#t;#e;#n;#s;#i;#r=new Set;get node(){return this.#e}get name(){return this.#n}get l(){return this.#n}get binding(){return this.#t}get u(){return this.#i}get filters(){return this.#s}get h(){return this.#r}constructor(t,e,n,s,i){this.#t=t,this.#e=e,this.#n=n,this.#s=s,this.#i=i}init(){}update(){this.p(this.binding.N.m)}p(t){b("BindingNode: assignValue not implemented")}S(t,e){b("BindingNode: updateElements not implemented")}get v(){return this.node instanceof HTMLSelectElement}get value(){return null}get m(){return null}get I(){return!1}}class E extends C{#o;get l(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}p(t){(null==t||Number.isNaN(t))&&(t="");this.node.setAttribute(this.l,t.toString())}}class P extends C{p(t){Array.isArray(t)||b("BindingNodeCheckbox.update: value is not array");const e=this.node;e.checked=t.map((t=>t.toString())).includes(e.value)}}class T extends C{p(t){Array.isArray(t)||b("BindingNodeClassList.update: value is not array");this.node.className=t.join(" ")}}class B extends C{#o;get l(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}p(t){"boolean"!=typeof t&&b("BindingNodeClassName.update: value is not boolean");const e=this.node;t?e.classList.add(this.l):e.classList.remove(this.l)}}class L extends C{#o;constructor(t,e,n,s,i){super(t,e,n,s,i),this.#o=this.name.slice(2);e.addEventListener(this.l,(t=>this.$(t)))}get l(){return this.#o}update(){}async $(t){const e=this.binding.C,n=this.binding.T.P,s=n?.B().map((t=>t.L.index))??[],i=this.u,r=this.binding.N.value;"function"!==typeof r&&b(`BindingNodeEvent: ${this.name} is not a function.`),i.includes("preventDefault")&&t.preventDefault(),i.includes("stopPropagation")&&t.stopPropagation(),await e.k(n,(async e=>{await Reflect.apply(r,e,[t,...s])}))}}const k=(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new L(s,i,t,o,n)},M="data-bind",R="@@:",F="@@|";class V extends C{#l;get id(){return this.#l}constructor(t,e,n,s,i){super(t,e,n,s,i);const r=this.node.textContent?.slice(3)??b("BindingNodeBlock.id: invalid node");this.#l=Number(r)}}class A extends V{#u;#c;#a=new Set;#r;get h(){return this.#r}constructor(t,e,n,s,i){super(t,e,n,s,i),this.#u=Ut(this.binding,this.id,this.binding.C,"",null),this.#c=this.#r=new Set([this.#u])}p(t){"boolean"!=typeof t&&b("BindingNodeIf.update: value is not boolean");const e=this.node.parentNode;null==e&&b("BindingNodeIf.update: parentNode is null"),t?(this.#u.o(),this.#u.M(e,this.node.nextSibling),this.#r=this.#c):(this.#u.unmount(),this.#r=this.#a)}}class O extends V{#h=new Set;#d=new WeakMap;#f=[];#p=0;#m=new Set;get h(){return this.#h}get I(){return!0}init(){}R(t){let e;return this.#p>=0?(e=this.#f[this.#p],this.#p--,e.F(t)):e=Ut(this.binding,this.id,this.binding.C,this.binding.N.pattern+".*",t),this.#d.set(t,e),e}V(t){t.unmount(),t.O?.A()}get H(){return this.#p}set H(t){this.#p=t}get j(){return this.#f.length}set j(t){t<0&&b("BindingNodeFor.setPoolLength: length is negative"),this.#f.length=t}p(t){Array.isArray(t)||b("BindingNodeFor.assignValue: value is not array");const e=this.binding.C.W(this.binding.N.info,this.binding.N.L);null===e&&b("BindingNodeFor.assignValue: listIndexes is not found");const n=new Set;let s=null;const i=new Set,r=this.#m.difference(e);for(const t of r){const e=this.#d.get(t);e&&(this.V(e),i.add(e))}this.#f.push(...i);const o=this.node.parentNode??b("BindingNodeFor.update: parentNode is null"),l=this.node;this.H=this.j-1;for(const t of e){const e=s?.q(o)??l;let i=this.#d.get(t);void 0===i?(i=this.R(t),i.o(),i.M(o,e)):e?.nextSibling!==i.D&&i.M(o,e),n.add(i),s=i}this.j=this.H+1,this.#h=n,this.#m=new Set(e)}S(t,e){if("object"!=typeof e[0])return;const n=this.binding.C,s=n.G(this.binding.N.info,this.binding.N.L)??b("BindingNodeFor.updateElements: oldValues is not found"),i=this.node.parentNode??b("BindingNodeFor.update: parentNode is null"),r=Array.from(this.#h),o=[];for(let e=0;e<t.length;e++){const n=r[t[e].index];n.unmount(),o.push(n)}for(let n=0;n<t.length;n++){const l=t[n],u=l.index,c=r[u-1]??null,a=c?._??this.node,h=s[u],d=e.indexOf(h),f=o[d];if(void 0===f){const t=o[u];t.o(),t.M(i,a)}else f.F(l),f.M(i,a),this.#d.set(l,f),r[u]=f;d>=0&&(e[d]=-1)}this.#h=new Set(r),n.Z(this.binding.N.info,this.binding.N.L,this.binding.N.value.slice(0))}}const H=(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new O(s,i,t,o,n)},j="textContent",z={radio:"checked",checkbox:"checked",button:"onclick"},W={},q={HTMLElement:t=>t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement||t instanceof HTMLOptionElement?"value":t instanceof HTMLButtonElement||t instanceof HTMLAnchorElement?"onclick":t instanceof HTMLFormElement?"onsubmit":t instanceof HTMLInputElement?z[t.type]??"value":j,SVGElement:void 0,Text:t=>j,U:void 0};const D={value:"input",checked:"change",selected:"change"};class G extends C{get value(){return this.node[this.name]}get m(){let t=this.value;for(let e=0;e<this.filters.length;e++)t=this.filters[e](t);return t}constructor(t,e,n,s,i){super(t,e,n,s,i);if(!(this.node instanceof HTMLElement))return;if(!((r=this.node)instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement))return;var r;const o=function(t,e){const n=t.constructor.name+"\t"+(t.type??"");return W[n]??(W[n]=q[e]?.(t))}(this.node,"HTMLElement");if(o!==this.name)return;i.length>1&&b(`BindingNodeProperty: ${this.name} has multiple decorators`);const l=(i[0]?.startsWith("on")?i[0]?.slice(2):i[0])??null??D[this.name]??"readonly";if("readonly"===l||"ro"===l)return;const u=this.binding.C;this.node.addEventListener(l,(async()=>{const e=this.binding.T.P,n=this.m;await u.k(e,(async e=>{t.J(e,n)}))}))}init(){}p(t){(null==t||Number.isNaN(t))&&(t=""),this.node[this.name]=t}}const _=(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new G(s,i,t,o,n)};class Z extends C{p(t){(null==t||Number.isNaN(t))&&(t="");const e=this.node;e.checked=t.toString()===e.value.toString()}}class U extends C{#o;get l(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}p(t){(null==t||Number.isNaN(t))&&(t="");this.node.style.setProperty(this.l,t.toString())}}const J="componentState",K=Symbol.for(`${J}.render`),Q=Symbol.for(`${J}.bindParentComponent`),X=Symbol.for(`${J}.names`),Y=Symbol.for(`${J}.GetPropertyValueFromChild`),tt=Symbol.for(`${J}.SetPropertyValueFromChild`);class et extends C{#o;get l(){return this.#o}constructor(t,e,n,s,i){super(t,e,n,s,i);const[,r]=this.name.split(".");this.#o=r}init(){const t=this.binding.C;let e=t.K.get(this.node);void 0===e&&(e=new Set,t.K.set(this.node,e)),e.add(this.binding)}p(t){this.node.state[K](this.l,t)}}const nt={0:{class:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new T(s,i,t,o,n)},checkbox:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new P(s,i,t,o,n)},radio:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new Z(s,i,t,o,n)}},1:{if:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new A(s,i,t,o,n)}}},st={class:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new B(s,i,t,o,n)},attr:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new E(s,i,t,o,n)},style:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new U(s,i,t,o,n)},state:(t,e,n)=>(s,i,r)=>{const o=$(r,e);return new et(s,i,t,o,n)}};const it={};function rt(t,e,n,s){const i=t instanceof Comment,r=t instanceof Element,o=i+"\t"+r+"\t"+e,l=it[o]??(it[o]=function(t,e,n){const s=nt[t?1:0][n];if(void 0!==s)return s;if(t&&"for"===n)return H;t&&b(`getBindingNodeCreator: unknown node property ${n}`);const i=n.split("."),r=st[i[0]];return void 0!==r?r:e&&n.startsWith("on")?k:_}(i,r,e));return l(e,n,s)}const ot="state",lt=Symbol.for(`${ot}.GetByRef`),ut=Symbol.for(`${ot}.SetByRef`),ct=Symbol.for(`${ot}.SetCacheable`),at=Symbol.for(`${ot}.ConnectedCallback`),ht=Symbol.for(`${ot}.DisconnectedCallback`),dt={};class ft{static id=0;id=++ft.id;pattern;X;Y;tt;et;nt;st;it;rt;ot;ut;ct;ht;dt;ft;yt;wt;bt;xt;Nt;St;children={};constructor(t){const e=e=>t===e?this:mt(e),n=t.split("."),s=[],i=[],r=[],o={},l=[],u=[],c=[];let a="",h="",d=0;for(let t=0;t<n.length;t++)a+=n[t],"*"===n[t]&&(r.push(a),o[a]=d,l.push(e(a)),u.push(h),c.push(e(h)),d++),s.push(a),i.push(e(a)),h=a,a+=".";const f=r.length>0?r[r.length-1]:null,p=s.length>1?s[s.length-2]:null;this.pattern=t,this.X=n,this.Y=n[n.length-1],this.tt=s,this.et=new Set(s),this.nt=i,this.st=new Set(i),this.it=r,this.rt=new Set(r),this.ut=o,this.ot=l,this.ct=new Set(l),this.ht=u,this.dt=new Set(u),this.ft=c,this.yt=new Set(c),this.wt=f,this.bt=f?e(f):null,this.xt=p,this.Nt=p?e(p):null,this.St=d,this.Nt&&(this.Nt.children[this.Y]=this)}}const pt=new Set(["constructor","prototype","__proto__","toString","valueOf","hasOwnProperty","isPrototypeOf","watch","unwatch","eval","arguments","let","var","const","class","function","null","true","false","new","return"]);function mt(t){let e;return e=dt[t],void 0!==e?e:(pt.has(t)&&b(`getStructuredPathInfo: pattern is reserved word: ${t}`),dt[t]=new ft(t))}class gt{#t;#g;#y;#w=null;#b;#s;get pattern(){return this.#g}get info(){return this.#y}get L(){return null===this.#w?null:this.#w.deref()??b("listIndex is null")}get state(){return this.#b}get filters(){return this.#s}get binding(){return this.#t}constructor(t,e,n,s){this.#t=t,this.#g=n,this.#y=mt(n),this.#b=e,this.#s=s}get value(){return this.#b[lt](this.info,this.L)}get m(){let t=this.value;for(let e=0;e<this.#s.length;e++)t=this.#s[e](t);return t}init(){if(this.info.St>0){const t=this.info.wt??b("BindingState.init: wildcardLastParentPath is null"),e=this.binding.T.O?.find(t)??b("BindingState.init: loopContext is null");this.#w=e.vt}this.binding.C.It(this.info,this.L,this.binding)}p(t,e){t[ut](this.info,this.L,e)}}class yt{#t;#x;#w=null;#b;#s;get pattern(){return b("Not implemented")}get info(){return b("Not implemented")}get L(){return null===this.#w?null:this.#w.deref()??b("listIndex is null")}get state(){return this.#b}get filters(){return this.#s}get binding(){return this.#t}constructor(t,e,n,s){this.#t=t;const i=Number(n.slice(1));isNaN(i)&&b("BindingStateIndex: pattern is not a number"),this.#x=i,this.#b=e,this.#s=s}get value(){return this.L?.index??b("listIndex is null")}get m(){let t=this.value;for(let e=0;e<this.#s.length;e++)t=this.#s[e](t);return t}init(){const t=(this.binding.T.P??b("BindingState.init: loopContext is null")).B();this.#w=t[this.#x-1].vt??b("BindingState.init: listIndexRef is null");const e=this.L??b("listIndex is null"),n=this.binding.C.$t.get(e);void 0===n?this.binding.C.$t.set(e,new Set([this.binding])):n.add(this.binding)}p(t,e){b("BindingStateIndex: assignValue is not implemented")}}const wt=new RegExp(/^\$\d+$/);function bt(t,e){return wt.test(t)?((t,e)=>(n,s,i)=>{const r=$(i,e);return new yt(n,s,t,r)})(t,e):((t,e)=>(n,s,i)=>{const r=$(i,e);return new gt(n,s,t,r)})(t,e)}const xt={};function Nt(t,e=(t=>t.constructor.name+"\t"+(t instanceof Comment?t.textContent?.[2]??"":""))(t)){return xt[e]??(xt[e]=(t=>t instanceof Comment&&":"===t.textContent?.[2]?"Text":t instanceof HTMLElement?"HTMLElement":t instanceof Comment&&"|"===t.textContent?.[2]?"Template":t instanceof SVGElement?"SVGElement":b(`Unknown NodeType: ${t.nodeType}`))(t))}const St=t=>t.trim(),vt=t=>t.length>0,It=new RegExp(/^#(.*)#$/),$t=t=>{const e=It.exec(t);return e?decodeURIComponent(e[1]):t},Ct=t=>{const[e,...n]=t.split(",").map(St);return{name:e,options:n.map($t)}},Et=t=>{const[e,...n]=t.split("|").map(St);return{Ct:e,filters:n.map(Ct)}},Pt=t=>t.split(";").map(St).filter(vt).map((t=>(t=>{const[e,n=null]=t.split("@").map(St),s=n?n.split(",").map(St):[],[i,r]=e.split(":").map(St),{Ct:o,filters:l}=Et(i),{Ct:u,filters:c}=Et(r);return{Et:o,Pt:u,Tt:l,Bt:c,u:s}})(t))),Tt={};const Bt=t=>{t.removeAttribute("data-bind")},Lt={HTMLElement:Bt,SVGElement:Bt,Text:void 0,U:void 0};const kt={Text:t=>{const e=document.createTextNode("");return t.parentNode?.replaceChild(e,t),e},HTMLElement:void 0,U:void 0,SVGElement:void 0};class Mt{nodeType;Lt;kt;Mt=new Map;constructor(t){this.nodeType=Nt(t);const e=function(t,e){switch(t){case"Text":return"textContent:"+(e.textContent?.slice(3).trim()??"");case"HTMLElement":case"SVGElement":return e.getAttribute(M)??"";case"Template":{const t=e.textContent?.slice(3).trim();return(zt(Number(t))??b(`Template not found: ${t}`)).getAttribute(M)??""}default:return""}}(this.nodeType,t);(function(t,e){Lt[e]?.(t)})(t=function(t,e){return kt[e]?.(t)??t}(t,this.nodeType),this.nodeType),this.Lt=function(t){let e=[];for(;null!==t.parentNode;)e=[Array.from(t.parentNode.childNodes).indexOf(t),...e],t=t.parentNode;return e}(t),this.kt=function(t){return""===t.trim()?[]:Tt[t]??(Tt[t]=Pt(t))}(e);for(let e=0;e<this.kt.length;e++){const n=this.kt[e],s={Rt:rt(t,n.Et,n.Tt,n.u),Ft:bt(n.Pt,n.Bt)};this.Mt.set(n,s)}}}function Rt(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT,{acceptNode:t=>t instanceof Element?t.hasAttribute(M)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:function(t){return t instanceof Comment&&(0===t.textContent?.indexOf(R)||0===t.textContent?.indexOf(F))}(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP});for(;n.nextNode();)e.push(n.currentNode);return e}const Ft={},Vt={},At={};function Ot(t){return Rt(t).map((t=>function(t){return new Mt(t)}(t)))}const Ht={};function jt(t,e,n){var s;return s=e.content,Array.from(s.childNodes).forEach((t=>{t.nodeType!==Node.TEXT_NODE||(t.nodeValue??"").trim()||s.removeChild(t)})),function(t,e,n=t){const s=Ot(e),i=At[n]??(At[n]=new Set),r=Vt[n]??(Vt[n]=new Set);for(let t=0;t<s.length;t++){const e=s[t];for(let t=0;t<e.kt.length;t++){const n=e.kt[t];i.add(n.Pt),"for"===n.Et&&r.add(n.Pt)}}Ft[t]=s}(t,e.content,n),Ht[t]=e,t}function zt(t){return Ht[t]??b(`getTemplateById: template not found: ${t}`)}class Wt{T;node;C;Vt;N;version;constructor(t,e,n,s,i){this.T=t,this.node=e,this.C=n,this.Vt=s(this,e,n.At),this.N=i(this,n.Ot,n.Ht)}get h(){return this.Vt.h}init(){this.Vt.init(),this.N.init()}o(){if(this.version!==this.C.jt.version)try{this.Vt.update()}finally{this.version=this.C.jt.version}}J(t,e){return this.N.p(t,e)}}function qt(t,e,n,s,i){return new Wt(t,e,n,s,i)}class Dt{#N;#y;#w;#u;constructor(t,e,n){this.#N=t??b("name is required"),this.#y=mt(this.#N),this.#w=new WeakRef(e),this.#u=n}get path(){return this.#N}get info(){return this.#y}get L(){return this.#w?.deref()??b("listIndex is null")}get vt(){return this.#w??b("listIndexRef is null")}F(t){this.#w=new WeakRef(t)}A(){this.#w=null}get zt(){return this.#u}#S;get Wt(){if(void 0===this.#S){let t=this.zt;for(;null!==t;){if(null!==t.O&&t.O!==this){this.#S=t.O;break}t=t.qt?.T??null}void 0===this.#S&&(this.#S=null)}return this.#S}#v={};find(t){let e=this.#v[t];if(void 0===e){let n=this;for(;null!==n&&n.path!==t;)n=n.Wt;e=this.#v[t]=n}return e}Dt(t){let e=this;for(;null!==e;)t(e),e=e.Wt}B(){const t=[];return this.Dt((e=>{t.unshift(e)})),t}}function Gt(t){const e=[];for(let n=0;n<t.length;n++){const s=t[n];s.Vt.v?e.push(s):s.o()}for(let t=0;t<e.length;t++)e[t].o()}function _t(t,e,n,s){const i=(t=>Ft[t])(e)??b("BindContent: data-bind is not set"),r=[];for(let e=0;e<i.length;e++){const l=i[e],u=(o=s,l.Lt.reduce(((t,e)=>t?.childNodes[e]??null),o)??b(`BindContent: node is not found: ${l.Lt}`));for(let e=0;e<l.kt.length;e++){const s=l.kt[e],i=l.Mt.get(s)??b(`BindContent: creator is not found: ${s}`),o=qt(t,u,n,i.Rt,i.Ft);r.push(o)}}var o;return r}class Zt{O;qt;childNodes;fragment;C;#l;get id(){return this.#l}get Gt(){return this.childNodes.length>0&&this.childNodes[0].parentNode!==this.fragment}get D(){return this.childNodes[0]??null}get _(){return this.childNodes[this.childNodes.length-1]??null}q(t){const e=this._t[this._t.length-1],n=this._;if(e.node===n&&e.h.size>0){const n=(Array.from(e.h).at(-1)??b("BindContent: childBindContent is not found")).q(t);if(null!==n)return n}return t!==n?.parentNode?null:n}#I;get P(){if(void 0===this.#I){let t=this;for(;null!==t&&null===t.O;)t=t.qt?.T??null;this.#I=t?.O??null}return this.#I}constructor(t,e,n,s,i){this.qt=t,this.#l=e,this.fragment=function(t){const e=zt(t)??b(`BindContent: template is not found: ${t}`);return document.importNode(e.content,!0)}(e),this.childNodes=Array.from(this.fragment.childNodes),this.C=n,this.O=null!==i?function(t,e,n){return new Dt(t,e,n)}(s,i,this):null,this._t=_t(this,e,n,this.fragment)}mount(t){if(0===this.fragment.childNodes.length)for(let e=0;e<this.childNodes.length;e++)t.appendChild(this.childNodes[e]);else t.appendChild(this.fragment)}Zt(t,e){if(0===this.fragment.childNodes.length)for(let n=0;n<this.childNodes.length;n++)t.insertBefore(this.childNodes[n],e);else t.insertBefore(this.fragment,e)}M(t,e){const n=e?.nextSibling??null;if(0===this.fragment.childNodes.length)for(let e=0;e<this.childNodes.length;e++)t.insertBefore(this.childNodes[e],n);else t.insertBefore(this.fragment,n)}unmount(){for(let t=0;t<this.childNodes.length;t++)this.fragment.appendChild(this.childNodes[t])}_t=[];o(){Gt(this._t)}init(){this._t.forEach((t=>t.init()))}F(t){null==this.O&&b("BindContent: loopContext is null"),this.O.F(t),this.init()}}function Ut(t,e,n,s,i){const r=new Zt(t,e,n,s,i);return r.init(),r}function Jt(t,e){return`${t.pattern}@${e}`}const Kt={};class Qt{C;Ut;Jt=new Set;constructor(t,e){this.C=t,this.Ut=e}Kt(t,e,n){const s=Jt(t,e);if(this.Jt.has(s))return;this.Jt.add(s),n(this.Ut,t,e);const i=this.C.Qt.get(t)??[];for(const t of i){const s="structured"===t.type?e:t.type;this.Kt(t.info,s,n)}}Dt(t){this.Kt(this.Ut.info,"structured",t)}}function Xt(t,e){return new Qt(t,e)}class Yt{static id=0;id=++Yt.id;#$=null;get Xt(){return this.#$}index;get Yt(){const t=this.Xt?.Yt??[];return t.push(this.index),t}get position(){return(this.Xt?.position??-1)+1}get length(){return(this.Xt?.length??0)+1}constructor(t,e){this.#$=t,this.index=e}truncate(t){let e=this;for(;null!==e;){if(e.position<t)return e;e=e.Xt}return null}add(t){return new Yt(this,t)}*te(){yield this,null!==this.Xt&&(yield*this.Xt.te())}*iterator(){null!==this.Xt&&(yield*this.Xt.iterator()),yield this}toString(){const t=this.Xt?.toString();return null!==t?t+","+this.index.toString():this.index.toString()}#C={};at(t){const e=this.#C[t];if(void 0!==e)return e?e.deref()??null:null;let n,s;for(t>=0?n=this.iterator():(t=-t-1,n=this.te());t>=0;)s=n.next(),t--;const i=s?.value??null;return this.#C[t]=i?new WeakRef(i):null,i}}function te(t,e){return new Yt(t,e)}function ee(t,e,n,s){const i=n?.length??0;if(e.St===i)s(e,n);else{const r=e.ft[i]??b("Invalid state property info"),o=t.W(r,n);for(const n of o??[])ee(t,e,n,s)}}function ne(t,e,n,s){ee(t,e,n,s)}function se(t,e){return t.id+":"+(e?.id??0)}const ie=new Set;function re(t,e,n,s){const i=t.G(e,n)??[];if(i===s)return;const r=new Set,o=t.W(e,n)??ie,l=Map.groupBy(o,(t=>i[t.index]));for(let e=0;e<s.length;e++){let i=l.get(s[e])?.shift()??te(n,e);i.index!==e&&(i.index=e,t.jt.ee(i)),r.add(i)}t.se(e,n,r),t.Z(e,n,s.slice(0))}function oe(t,e,n,s,i){for(const{info:r,L:o}of t){if(u.optimizeListElements&&e.ie.has(r))continue;const t=Xt(e,{info:r,L:o}),l=u.optimizeList&&e.re.has(r);t.Dt(((t,r,o)=>{if(l&&"structured"===o&&t.info!==r&&r.st.has(t.info))return;const u=Array.from(t.info.ct.intersection(r.ct)),c=(u.at(-1)?.St??0)-1,a=c>=0?t.L?.at(c)??null:null;ne(e,r,a,((t,r)=>{if(!e.oe(t))return;const o=se(t,r);if(s.has(o))return;let l=i.get(t);if(l||(l=new Set,i.set(t,l)),l.add(r),s.add(o),e.re.has(t)){const s=n[o]??e.Ot[lt](t,r);re(e,t,r,s)}}))}))}}class le{ue=new Set;ce={};C;#E=0;constructor(t){this.C=t}get version(){return this.#E}ae(t){queueMicrotask(t)}he(t,e,n){const s=se(t,e);this.ue.add({info:t,L:e}),this.ce[s]=n,this.de()}ee(t){this.ue.add(t),this.de()}#P=!1;de(){this.#P||(this.#P=!0,queueMicrotask((()=>{try{const{_t:t,fe:e}=this.pe();for(const t of e)t.binding.Vt.S(t.me,t.values);t.length>0&&this.o(t)}finally{this.#P=!1}})))}pe(){const t=[],e=[],n=this.C;for(;this.ue.size>0;){const s=Array.from(this.ue.values());this.ue.clear();const i=[],r=[],o=new Map;for(let t=0;t<s.length;t++){const e=s[t];if("index"in e){const t=n.$t.get(e)??[];i.push(...t)}else if(r.push(e),n.ie.has(e.info)){const t=e.info.Nt??b("info is null"),n=e.L?.at(-2)??null,s={info:t,L:n},i=se(t,n);let r=o.get(i);r||(r={ye:s,me:[],values:[]},o.set(i,r));const l=se(e.info,e.L),u=this.ce[l]??null;r.values?.push(u),r.me?.push(e.L)}}const l=new Set,u=new Map;oe(r,n,this.ce,l,u);for(const[e,s]of o){const e=s.ye?.info??b("parentInfo is null"),i=s.ye?.L??null,r=n.we(e,i);for(const e of r){if(!e.Vt.I)continue;const n=Object.assign({},s,{binding:e});t.push(n)}}for(const[t,s]of u.entries())for(const i of s){const s=n.we(t,i);e.push(...s??[])}e.push(...i)}return this.ce={},{_t:e,fe:t}}o(t){this.#E++,this.C.Ot[ct]((()=>Gt(t)))}}function ue(t,e,n){if(e.enableShadowDom)if(null===e.be||function(t){try{return"function"==typeof document.createElement(t).attachShadow}catch{return!1}}(e.be)){t.attachShadow({mode:"open"}).adoptedStyleSheets=[n]}else b(`ComponentEngine: Shadow DOM not supported for builtin components that extend ${e.be}`);else{const e=function(t){let e=t;for(;e;){if(e instanceof ShadowRoot)return e;e=e.parentNode}}(t.parentNode)||document,s=e.adoptedStyleSheets;s.includes(n)||(e.adoptedStyleSheets=[...s,n])}}const ce=new Set;function ae(t,e,n,s,i){const r=t.G(n,s)??[];if(r===i)return;const o=new Set,l=t.W(n,s)??ce,u=Map.groupBy(l,(t=>r[t.index]));for(let e=0;e<i.length;e++){let n=u.get(i[e])?.shift()??te(s,e);n.index!==e&&(n.index=e,t.jt.ee(n)),o.add(n)}t.se(n,s,o),t.Z(n,s,i.slice(0));const c=n.pattern+".*";for(const n of e)if(c===n.wt)for(const s of o){const i=t.Ot[lt](n,s);ae(t,e,n,s,i??[])}}function he(t,e,n,s){if(t.re,!t.re.has(e))return;const i=s??[];ae(t,t.re,e,n,i)}const de={};class fe{static id=0;id=++fe.id;name;elements;xe;St;Ne;Se;info;constructor(t){const e=t.split("."),n=e.slice(),s=[];let i=0,r=0,o="",l=0,u="none",c=[];for(let t=0;t<e.length;t++){const u=e[t];if("*"===u)n[t]="*",c.push(null),i++,l++;else{const e=Number(u);Number.isNaN(e)||(n[t]="*",c.push(e),r++,l++)}o+=u,s.push(o),o+=t<e.length-1?".":""}const a=mt(n.join("."));(i>0||r>0)&&(u=i===l?"context":r===l?"all":"partial"),this.name=t,this.elements=e,this.xe=s,this.St=l,this.Ne=u,this.Se=c,this.info=a}}function pe(t){return de[t]??(de[t]=new fe(t))}function me(t,e){const n=t.ve[t.Ie];if(null==n)return null;const s=n.ut[e];if(s>=0){const e=t.$e[t.Ie];return void 0===e?null:e?.at(s)??null}return null}function ge(t,e,n){switch(t.Ne){case"none":return null;case"context":return me(n,t.info.wt??b("lastWildcardPath is null"))??b(`ListIndex not found: ${t.info.pattern}`);case"all":let e=null;for(let s=0;s<t.info.St;s++){const i=t.info.ft[s]??b("wildcardParentPattern is null");e=Array.from(n.C.W(i,e)??[])[t.Se[s]??b("wildcardIndex is null")]??b(`ListIndex not found: ${i.pattern}`)}return e;case"partial":b(`Partial wildcard type is not supported yet: ${t.info.pattern}`)}}function ye(t,e,n,s){t.Ie++,t.Ie>=t.ve.length&&(t.ve.push(null),t.$e.push(null)),t.ve[t.Ie]=e,t.$e[t.Ie]=n;try{return s()}finally{t.ve[t.Ie]=null,t.$e[t.Ie]=null,t.Ie--}}function we(t,e,n){const s=e.Ce[e.Ee]??null;null!=s&&e.C.Pe.has(s.pattern)&&e.C.Te(s,t,"reference"),e.Ee++,e.Ee>=e.Ce.length&&e.Ce.push(null),e.Ce[e.Ee]=t,e.Be=e.Ce[e.Ee]??null;try{return n()}finally{e.Ce[e.Ee]=null,e.Ee--,e.Be=e.Ce[e.Ee]??null}}function be(t,e,n,s,i){return we(e,i,(()=>function(t,e,n,s,i){let r,o="";if(i.Le){o=se(e,n);const t=i.cache[o];if(void 0!==t)return t;if(o in i.cache)return}try{if(i.C.ke.state[X].has(e.tt[0])&&e.tt.length>1)return r=i.C.ke.state[Y](e.pattern);if(e.pattern in t)return r=ye(i,e,n,(()=>Reflect.get(t,e.pattern,s)));{const o=e.Nt??b("propRef.stateProp.parentInfo is undefined"),l=o.St<e.St?n?.Xt??null:n,u=be(t,o,l,s,i),c=e.Y;if("*"===c){const t=n?.index??b("propRef.listIndex?.index is undefined");return r=Reflect.get(u,t)}return r=Reflect.get(u,c)}}finally{i.Le&&!(o in i.cache)&&(i.cache[o]=r)}}(t,e,n,s,i)))}function xe(t,e,n,s){return(e,i,r)=>{const o=mt(e);null!=s.Be&&s.C.Pe.has(s.Be.pattern)&&s.C.Te(s.Be,o,"reference");let l=null;for(let t=0;t<o.ft.length;t++){const e=o.ft[t]??b("wildcardParentPath is null");l=Array.from(s.C.W(e,l)??[])[i[t]??b("index is null")]??b(`ListIndex not found: ${e.pattern}`)}if(void 0===r)return be(t,o,l,n,s);b(`Cannot set value on a readonly proxy: ${e}`)}}function Ne(t,e,n,s){return t=>{const e=mt(t);null!=s.Be&&s.C.Pe.has(s.Be.pattern)&&s.C.Te(s.Be,e,"reference")}}function Se(t,e,n,s){if("string"==typeof e){if(36===e.charCodeAt(0)){if(2===e.length){const t=e.charCodeAt(1)-48;if(t>=1&&t<=9){const n=s.$e[s.Ie];return n?.at(t-1)?.index??b(`ListIndex not found: ${e}`)}}switch(e){case"$resolve":return xe(t,0,n,s);case"$getAll":return function(t,e,n,s){const i=xe(t,0,n,s);return(t,e)=>{const n=mt(t);if(null!=s.Be&&s.C.Pe.has(s.Be.pattern)&&s.C.Te(s.Be,n,"reference"),void 0===e){for(let t=0;t<n.ot.length;t++){const i=n.ot[t]??b("wildcardPattern is null"),r=me(s,i.pattern);if(r){e=r.Yt;break}}void 0===e&&(e=[])}const r=(t,e,n,i,o,l,u)=>{const c=t[e]??null;if(null===c)return void u.push(l);const a=s.C.W(c,n)??b(`ListIndex not found: ${c.pattern}`),h=Array.from(a),d=i[o]??null;if(null===d)for(let n=0;n<h.length;n++){const s=h[n];r(t,e+1,s,i,o+1,l.concat(s.index),u)}else{const n=h[d]??b(`ListIndex not found: ${c.pattern}`);e+1<t.length&&r(t,e+1,n,i,o+1,l.concat(n.index),u)}},o=[];r(n.ft,0,null,e,0,[],o);const l=[];for(let t=0;t<o.length;t++)l.push(i(n.pattern,o[t]));return l}}(t,0,n,s);case"$trackDependency":return Ne(0,0,0,s);case"$navigate":return t=>r()?.navigate(t)}}const i=pe(e),o=ge(i,0,s);return be(t,i.info,o,n,s)}if("symbol"==typeof e)switch(e){case lt:return(e,i)=>be(t,e,i,n,s);case ct:return t=>function(t,e){t.Le=!0,t.cache={};try{e()}finally{t.Le=!1}}(s,t);default:return Reflect.get(t,e,n)}}let ve=class{C;Le=!1;cache={};Be=null;Ce=Array(32).fill(null);Ee=-1;ve=Array(32).fill(null);$e=Array(32).fill(null);Ie=-1;O=null;constructor(t){this.C=t}get(t,e,n){return Se(t,e,n,this)}set(t,e,n,s){b(`Cannot set property ${String(e)} of readonly state.`)}};function Ie(t,e){return new Proxy(e,new ve(t))}function $e(t,e,n,s,i){return we(e,i,(()=>function(t,e,n,s,i){if(i.C.ke.state[X].has(e.tt[0])&&e.tt.length>1)return i.C.ke.state[Y](e.pattern);if(e.pattern in t)return ye(i,e,n,(()=>Reflect.get(t,e.pattern,s)));{const r=e.Nt??b("propRef.stateProp.parentInfo is undefined"),o=r.St<e.St?n?.Xt??null:n,l=$e(t,r,o,s,i),u=e.Y;if("*"===u){const t=n?.index??b("propRef.listIndex?.index is undefined");return Reflect.get(l,t)}return Reflect.get(l,u)}}(t,e,n,s,i)))}function Ce(t,e,n,s,i,r){try{if(r.C.ke.state[X].has(e.tt[0])&&e.tt.length>1)return r.C.ke.state[tt](e.pattern,s);if(e.pattern in t)return ye(r,e,n,(()=>Reflect.set(t,e.pattern,s,i)));{const o=e.Nt??b("propRef.stateProp.parentInfo is undefined"),l=o.St<e.St?n?.Xt??null:n,u=$e(t,o,l,i,r),c=e.Y;if("*"===c){const t=n?.index??b("propRef.listIndex?.index is undefined");return Reflect.set(u,t,s)}return Reflect.set(u,c,s)}}finally{r.C.jt.he(e,n,s)}}function Ee(t,e,n,s){return(e,i,r)=>{const o=mt(e);null!=s.Be&&s.C.Pe.has(s.Be.pattern)&&s.C.Te(s.Be,o,"reference");let l=null;for(let t=0;t<o.ft.length;t++){const e=o.ft[t]??b("wildcardParentPath is null");l=Array.from(s.C.W(e,l)??[])[i[t]??b("index is null")]??b(`ListIndex not found: ${e.pattern}`)}return void 0===r?$e(t,o,l,n,s):Ce(t,o,l,r,n,s)}}function Pe(t,e,n,s){if("string"==typeof e){if(36===e.charCodeAt(0)){if(2===e.length){const t=e.charCodeAt(1)-48;if(t>=1&&t<=9){const n=s.$e[s.Ie];return n?.at(t-1)?.index??b(`ListIndex not found: ${e}`)}}switch(e){case"$resolve":return Ee(t,0,n,s);case"$getAll":return function(t,e,n,s){const i=Ee(t,0,n,s);return(t,e)=>{const n=mt(t);if(null!=s.Be&&s.C.Pe.has(s.Be.pattern)&&s.C.Te(s.Be,n,"reference"),void 0===e){for(let t=0;t<n.ot.length;t++){const i=n.ot[t]??b("wildcardPattern is null"),r=me(s,i.pattern);if(r){e=r.Yt;break}}void 0===e&&(e=[])}const r=(t,e,n,i,o,l,u)=>{const c=t[e]??null;if(null===c)return void u.push(l);const a=s.C.W(c,n)??b(`ListIndex not found: ${c.pattern}`),h=Array.from(a),d=i[o]??null;if(null===d)for(let n=0;n<h.length;n++){const s=h[n];r(t,e+1,s,i,o+1,l.concat(s.index),u)}else{const n=h[d]??b(`ListIndex not found: ${c.pattern}`);e+1<t.length&&r(t,e+1,n,i,o+1,l.concat(n.index),u)}},o=[];r(n.ft,0,null,e,0,[],o);const l=[];for(let t=0;t<o.length;t++)l.push(i(n.pattern,o[t]));return l}}(t,0,n,s);case"$trackDependency":return Ne(0,0,0,s);case"$navigate":return t=>r()?.navigate(t)}}const i=pe(e),o=ge(i,0,s);return $e(t,i.info,o,n,s)}if("symbol"==typeof e)switch(e){case lt:return(e,i)=>$e(t,e,i,n,s);case ut:return(e,i,r)=>Ce(t,e,i,r,n,s);case at:return()=>function(t,e,n){return async()=>{const e=Reflect.get(t,"$connectedCallback");"function"==typeof e&&await e.call(t,n)}}(t,0,n);case ht:return()=>function(t,e,n){return async()=>{const e=Reflect.get(t,"$disconnectedCallback");"function"==typeof e&&await e.call(t,n)}}(t,0,n);default:return Reflect.get(t,e,n)}}class Te{C;Be=null;Ce=Array(32).fill(null);Ee=-1;ve=Array(32).fill(null);$e=Array(32).fill(null);Ie=-1;O=null;constructor(t){this.C=t}get(t,e,n){return Pe(t,e,n,this)}set(t,e,n,s){return function(t,e,n,s,i){if("string"==typeof e){const r=pe(e),o=ge(r,0,i);return Ce(t,r.info,o,n,s,i)}return Reflect.set(t,e,n,s)}(t,e,n,s,this)}}async function Be(t,e,n=null,s){const i=new Te(t),r=new Proxy(e,i);return async function(t,e,n){t.O&&b("already in loop context"),t.O=e;try{e?await async function(t,e,n,s){t.Ie++,t.Ie>=t.ve.length&&(t.ve.push(null),t.$e.push(null)),t.ve[t.Ie]=e,t.$e[t.Ie]=n;try{await s()}finally{t.ve[t.Ie]=null,t.$e[t.Ie]=null,t.Ie--}}(t,e.info,e.L,n):await n()}finally{t.O=null}}(i,n,(async()=>{await s(r)}))}class Le{type="autonomous";config;Me;styleSheet;Re;state;Ot;jt;At;Ht;#u=null;get zt(){return null===this.#u&&b("bindContent is not initialized yet"),this.#u}Fe=HTMLElement;ke;Pe;re=new Set;ie=new Set;$t=new WeakMap;Qt=new Map;K=new WeakMap;#T=Promise.withResolvers();constructor(t,e){this.config=t,this.config.be&&(this.type="builtin");const n=e.constructor;this.Me=n.Me,this.styleSheet=n.styleSheet,this.Re=n.Re,this.state=new this.Re,this.Ot=Ie(this,this.state),this.jt=new le(this),this.At=n.At,this.Ht=n.Ht,this.ke=e,this.Pe=n.Pe;const s=t=>{const e=t.Nt;null!==e&&(this.Te(t,e,"structured"),s(e))};for(const t of n.xe){const e=mt(t);s(e)}for(const t of n.Ve)this.re.add(mt(t)),this.ie.add(mt(t+".*"))}Ae(){const t=this.ke.constructor;for(const t of this.re){if(t.St>0)continue;he(this,t,null,this.Ot[lt](t,null))}this.#u=Ut(null,t.id,this,null,null)}get Oe(){return this.#T}async connectedCallback(){if(await(this.ke.He?.Oe.promise),this.ke.dataset.state)try{const t=JSON.parse(this.ke.dataset.state);await this.k(null,(async e=>{for(const[n,s]of Object.entries(t)){const t=mt(n);t.St>0||e[ut](t,null,s)}}))}catch(t){b("Failed to parse state from dataset")}this.ke.state[Q](),ue(this.ke,this.config,this.styleSheet),this.zt.o(),await this.k(null,(async t=>{await t[at]()})),queueMicrotask((()=>{this.zt.mount(this.ke.shadowRoot??this.ke),this.#T.resolve()}))}async disconnectedCallback(){await this.k(null,(async t=>{await t[ht]()}))}#B={};#L={};je(){return{list:null,ze:null,_t:[]}}We(t,e){if(null===e){let e=this.#L[t.id];return void 0===e&&(e=this.je(),this.#L[t.id]=e),e}{let n=this.#B[t.id];void 0===n&&(n=new WeakMap,this.#B[t.id]=n);let s=n.get(e);return void 0===s&&(s=this.je(),n.set(e,s)),s}}It(t,e,n){this.We(t,e)._t.push(n)}se(t,e,n){this.We(t,e).ze=n}Z(t,e,n){this.We(t,e).list=n}we(t,e){return this.We(t,e)._t}oe(t){return void 0!==this.#L[t.id]||void 0!==this.#B[t.id]}W(t,e){return this.We(t,e).ze}G(t,e){return this.We(t,e).list}Te(t,e,n){let s=this.Qt.get(e);void 0===s&&(s=new Set,this.Qt.set(e,s));const i=function(t,e){const n=Jt(t,e);return Kt[n]??(Kt[n]={info:t,type:e})}(t,n);s.add(i)}getPropertyValue(t,e){return Ie(this,this.state)[lt](t,e)}qe(t,e,n){this.jt.ae((()=>{this.k(null,(async s=>{s[ut](t,e,n)}))}))}De(){return Ie(this,this.state)}async k(t,e){return Be(this,this.state,t,e)}}const ke=/\{\{([^\}]+)\}\}/g,Me=new Set(["if","for","endif","endfor","elseif","else"]);function Re(t,e,n=t){if(e.parentNode?.replaceChild(document.createComment(`${F}${t}`),e),"http://www.w3.org/2000/svg"===e.namespaceURI){const t=document.createElement("template");for(let n of Array.from(e.childNodes))t.content.appendChild(n);const n=e.getAttribute(M);t.setAttribute(M,n??""),e=t}return e.content.querySelectorAll("template").forEach((t=>{Re(w(),t,n)})),jt(t,e,n),t}function Fe(t,e){const n=document.createElement("template");n.dataset.id=t.toString(),n.innerHTML=function(t){const e=[];return t.replaceAll(ke,((t,n)=>{n=n.trim();const[s]=n.split(":");if(!Me.has(s))return`\x3c!--${R}${n}--\x3e`;const i=n.slice(s.length+1).trim(),r={type:s,Ge:n,_e:i};if("if"===s||"for"===s)return e.push(r),`<template data-bind="${n}">`;if("endif"===s){const t=[];for(;;){const n=e.pop()??b("replaceMustacheToTemplateOrEmbed: endif without if");if("if"===n.type){t.push("</template>");break}"elseif"===n.type?t.push("</template>"):b("replaceMustacheToTemplateOrEmbed: endif without if")}return t.join("")}if("endfor"===s){if("for"===(e.pop()??b("replaceMustacheToTemplateOrEmbed: endif without if")).type)return"</template>";b("replaceMustacheToTemplateOrEmbed: endfor without for")}else if("elseif"===s){const t=e.at(-1)??b("replaceMustacheToTemplateOrEmbed: elseif without if");if("if"===t.type||"elseif"===t.type)return e.push(r),`</template><template data-bind="if:${t._e}|not"><template data-bind="if:${i}">`;b("replaceMustacheToTemplateOrEmbed: elseif without if")}else if("else"===s){const t=e.at(-1)??b("replaceMustacheToTemplateOrEmbed: else without if");if("if"===t.type)return`</template><template data-bind="if:${t._e}|not">`;b("replaceMustacheToTemplateOrEmbed: else without if")}else b("replaceMustacheToTemplateOrEmbed: unknown type")}))}(e),Re(t,n)}class Ve{C;Ze={};#k;constructor(t){this.C=t}get names(){return this.#k??new Set}Ue(t){const e=t.Vt.l;this.Ze[e]=t,Object.defineProperty(this.C.state,e,{get:()=>t.N.m,set:e=>{const n=t.C,s=t.T.P;n.jt.ae((async()=>{n.k(s,(async n=>t.J(n,e)))}))}})}Je(t){const e=t.Vt.l;Object.defineProperty(this.C.state,e,{value:void 0})}Ke(){const t=this.C.ke.He;if(null===t)return;const e=t.Qe(this.C.ke);for(const t of e??[])this.Ue(t);this.#k=new Set(Object.keys(this.Ze))}o(t,e){if(!this.names.has(t))return;const n=mt(t);this.C.jt.he(n,null,e)}getPropertyValue(t){const e=mt(t);return this.C.getPropertyValue(e,null)}qe(t,e){const n=mt(t);this.C.qe(n,null,e)}Xe(t){const e=mt(t).tt[0];if(!this.names.has(e))return;const n=this.Ze[e],s=t.slice(e.length),i=mt(n?.N.pattern+s),r=n.N.L??null;return n.N.state[lt](i,r)}Ye(t,e){const n=mt(t).tt[0];if(!this.names.has(n))return;const s=this.Ze[n],i=s.T.P,r=t.slice(n.length),o=mt(s?.N.pattern+r),l=s.N.L??null,u=s.C;u.jt.ae((async()=>{u.k(i,(async t=>t[ut](o,l,e)))}))}}class Ae{get(t,e,n){return e===K?t.o.bind(t):e===Q?t.Ke.bind(t):e===X?t.names:e===Y?t.Xe.bind(t):e===tt?t.Ye.bind(t):"string"==typeof e?t.getPropertyValue(e):Reflect.get(t,e,n)}set(t,e,n,s){return"string"==typeof e?(t.qe(e,n),!0):Reflect.set(t,e,n,s)}}const Oe=/^[a-zA-Z_$][0-9a-zA-Z_$]*$/,He=/^[a-zA-Z_$][0-9a-zA-Z_$]*(\.[a-zA-Z_$][0-9a-zA-Z_$]*|\.\*)*$/;function je(t,e){const n=new Set(t.tt).intersection(e);let s=-1,i="";for(const t of n){const e=t.split(".");1!==e.length&&(e.length>s&&(s=e.length,i=t))}if(i.length>0){if(!He.test(i))throw new Error(`Invalid path: ${i}`);const e=mt(i),n=[];let s=e.St;for(let i=e.X.length;i<t.X.length;i++){const e=t.X[i];if("*"===e)n.push("[this.$"+(s+1)+"]"),s++;else{if(!Oe.test(e))throw new Error(`Invalid segment name: ${e}`);n.push("."+e)}}const r=n.join("");return{get:new Function("",`return this["${i}"]${r};`),set:new Function("value",`this["${i}"]${r} = value;`)}}{const e=[];let n=0;for(const s of t.X)if("*"===s)e.push("[this.$"+(n+1)+"]"),n++;else{if(!Oe.test(s))throw new Error(`Invalid segment name: ${s}`);e.push((e.length>0?".":"")+s)}const s=e.join("");return{get:new Function("",`return this.${s};`),set:new Function("value",`this.${s} = value;`)}}}function ze(t){const e=function(t){const e=l();return{enableShadowDom:t.enableShadowDom??e.enableShadowDom,be:t.be??null}}(t.Re.tn??{}),n=w(),{en:s,nn:i,Re:r}=t,o=Object.assign({},g),c=Object.assign({},m);r.sn=!0,Fe(n,s),S(n,i),function(t,e){x[t]=e}(n,r);const a=function(t){return t?document.createElement(t).constructor:HTMLElement}(e.be),h=e.be;return class extends a{#M;#R;constructor(){var t;super(),this.#M=function(t,e){return new Le(t,e)}(e,this),this.#R=(t=this.#M,new Proxy(new Ve(t),new Ae)),this.#M.Ae()}connectedCallback(){this.#M.connectedCallback()}disconnectedCallback(){this.#M.disconnectedCallback()}#F;get He(){return void 0===this.#F&&(this.#F=function(t){let e=t.parentNode;for(;e;){if(e.state&&e.rn)return e;if(e=e.parentNode,e instanceof ShadowRoot){if(e.host&&e.host.state&&e.host.rn)return e.host;e=e.host}}return null}(this)),this.#F}get state(){return this.#R}get rn(){return this.#M.Re.sn??!1}get Oe(){return this.#M.Oe}Qe(t){return this.#M.K.get(t)??null}static define(t){h?customElements.define(t,this,{be:h}):customElements.define(t,this)}static get id(){return n}static#V=s;static get en(){return this.#V}static set en(t){this.#V=t,Fe(this.id,t),this.#A=null}static#O=i;static get nn(){return this.#O}static set nn(t){this.#O=t,S(this.id,t),this.#H=null}static#A=null;static get Me(){return this.#A||(this.#A=zt(this.id)),this.#A}static#H=null;static get styleSheet(){return this.#H||(this.#H=function(t){return N[t]??b(`getStyleSheetById: stylesheet not found: ${t}`)}(this.id)),this.#H}static#j=null;static get Re(){return this.#j||(this.#j=function(t){return x[t]??b(`getStateClassById: stateClass not found: ${t}`)}(this.id)),this.#j}static#z=o;static get At(){return this.#z}static#W=c;static get Ht(){return this.#W}static get Ve(){return(t=>Vt[t]??[])(this.id)}static get xe(){return(t=>At[t]??[])(this.id)}static#q=null;static get ln(){return this.#q??b("getters is null")}static#D=null;static get Pe(){if(null===this.#D){this.#D=new Set,this.#q=new Set;let t=this.Re.prototype;for(;t&&t!==Object.prototype;){const e=Object.getOwnPropertyDescriptors(t);if(e)for(const[t,n]of Object.entries(e))n.get&&!n.set&&this.#D.add(t),this.#q.add(t);t=Object.getPrototypeOf(t)}if(u.optimizeAccessor)for(const t of this.xe){const e=mt(t);if(1===e.X.length)continue;if(this.#q.has(t))continue;const n=je(e,this.#q);Object.defineProperty(this.Re.prototype,t,{get:n.get,set:n.set,enumerable:!0,configurable:!0})}}return this.#D}}}function We(t){return t.replaceAll(/<!--\{\{([^\}]+)\}\}-->/g,((t,e)=>`{{${e}}}`))}async function qe(t){const e=await fetch(import.meta.resolve(t));return async function(t){const e=document.createElement("template");e.innerHTML=function(t){return t.replaceAll(/\{\{([^\}]+)\}\}/g,((t,e)=>`\x3c!--{{${e}}}--\x3e`))}(t);const n=e.content.querySelector("template");n?.remove();const s=e.content.querySelector("script[type=module]"),i=btoa(String.fromCodePoint(...(new TextEncoder).encode(s.text))),r=s?await import("data:application/javascript;base64,"+i):{};s?.remove();const o=e.content.querySelector("style");o?.remove();const l=r.default??class{};return{text:t,en:We(n?.innerHTML??"").trim(),nn:o?.textContent??"",Re:l}}(await e.text())}function De(t,e){e.define(t)}const Ge="router",_e=`<slot name="${Ge}"></slot>`;class Ze extends HTMLElement{constructor(){super(),u.enableShadowDom&&this.attachShadow({mode:"open"})}async connectedCallback(){await this.un(),this.o()}get root(){return this.shadowRoot??this}async un(){if(u.layoutPath){const t=await fetch(u.layoutPath);if(t.ok){const e=await t.text(),n=document.createElement("template");n.innerHTML=e;const s=n.content.querySelector("template"),i=n.content.querySelector("style");if(this.root.appendChild(s?.content??document.createDocumentFragment()),i){const t=this.shadowRoot??document,e=t.adoptedStyleSheets;e.includes(i)||(t.adoptedStyleSheets=[...e,i])}}else b(`Failed to load layout from ${u.layoutPath}`)}else this.root.innerHTML=_e}o(){if(u.enableRouter){const t=document.createElement(u.routerTagName);t.setAttribute("slot",Ge),this.root.appendChild(t)}}}const Ue="@routes/",Je="@components/";async function Ke(){const t=function(){const t={};return document.querySelectorAll("script[type='importmap']").forEach((e=>{const n=JSON.parse(e.innerHTML);n.imports&&(t.imports=Object.assign(t.imports||{},n.imports))})),t}();if(t.imports)for(const[e,n]of Object.entries(t.imports)){let t;if(e.startsWith(Ue)){const n=e.slice(7);t="routes"+n.replace(/:[^\s/]+/g,"").replace(/\//g,"-"),i(t,"/root"===n?"/":n)}if(e.startsWith(Je)&&(t=e.slice(12)),!t)continue;let n=null;n=await qe(e);De(t,ze(n))}}const Qe=u;let Xe=!1;async function Ye(t){await async function(t){for(const[e,n]of Object.entries(t)){let t=null;if(u.enableRouter){const t=n.startsWith("@routes")?n.slice(7):n;i(e,"/root"===t?"/":t)}t=await qe(n),De(e,ze(t))}}(t),Qe.autoInit&&await tn()}async function tn(){Xe||(await async function(){if(u.autoLoadFromImportMap&&await Ke(),u.enableRouter&&customElements.define(u.routerTagName,s),u.enableMainWrapper&&(customElements.define(u.mainTagName,Ze),u.autoInsertMainWrapper)){const t=document.createElement(u.mainTagName);document.body.appendChild(t)}}(),Xe=!0)}export{tn as bootstrapStructive,Qe as config,Ye as defineComponents};
//# sourceMappingURL=structive.min.js.map
